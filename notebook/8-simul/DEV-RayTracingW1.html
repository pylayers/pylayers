<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20. Simulation Creation &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../../index.html" />
    <link rel="up" title="User Manual" href="../index.html" />
    <link rel="next" title="21. Example of an UWB channel Ray Tracing simulation" href="DOC-RayTracing2.html" />
    <link rel="prev" title="13. Synthesis of Ultra Wide Band Waveforms" href="../4-signal/UwbWaveforms.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../../index.html"><img src="../../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="DOC-RayTracing2.html" title="21. Example of an UWB channel Ray Tracing simulation"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../4-signal/UwbWaveforms.html" title="13. Synthesis of Ultra Wide Band Waveforms"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../index.html" accesskey="U">User Manual</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">20. Simulation Creation</a><ul>
<li><a class="reference internal" href="#adding-coordinates-of-transmiting-and-receiving-points">20.1. Adding coordinates of transmiting and receiving points</a></li>
<li><a class="reference internal" href="#signatures-rays-and-channel">20.2. Signatures, Rays and channel</a></li>
<li><a class="reference internal" href="#apply-waveform">20.3. Apply waveform</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../4-signal/UwbWaveforms.html"
                        title="previous chapter">13. Synthesis of Ultra Wide Band Waveforms</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DOC-RayTracing2.html"
                        title="next chapter">21. Example of an UWB channel Ray Tracing simulation</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="simulation-creation">
<h1>20. Simulation Creation<a class="headerlink" href="#simulation-creation" title="Permalink to this headline">¶</a></h1>
<p>A ray-tracing simulation is controlled via a configuration file which is
stored in the <em>ini</em> directory of the project directory. By default,
there is a default configuration file named <strong>default.ini</strong>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pylayers.simul.simulem</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.rays</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.channel</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.signature</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.measures.mesuwb</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">import</span> <span class="nn">pylayers.signal.bsignal</span> <span class="kn">as</span> <span class="nn">bs</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.figure.Figure at 0x4d12850&gt;</pre>
</div>
<p>A first step consists in loading a layout associated with the
simulation. Here the <tt class="docutils literal"><span class="pre">WHERE1.ini</span></tt> layout is chosen along with the
corresponding slabs and materials.</p>
<p>This layout corresponds to the office building where the first WHERE1
UWB measurement campaign has been conducted.</p>
<p>The layout method loads those in a member layout object <strong>L</strong> of the
simulation object <strong>S</strong>.</p>
<p>If not already available, the layout associated graphs are built.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span> <span class="o">=</span> <span class="n">Simul</span><span class="p">()</span>
<span class="c"># loading a layout</span>
<span class="n">filestr</span> <span class="o">=</span> <span class="s">&#39;WHERE1&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">filestr</span><span class="o">+</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span><span class="s">&#39;matDB.ini&#39;</span><span class="p">,</span><span class="s">&#39;slabDB.ini&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">dumpr</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">dumpw</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0x3ea1e10&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x4d1cc90&gt;)</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_5_1.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_5_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">figsize</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGi</span><span class="p">(</span><span class="n">en</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>int0 :  (309, 15, 46)
int1 :  (202, 46, 59)
 output  {'(137, 59, 58)': 0.64242282168494413, '(230, 59, 67)': 0.35757717831506564, '(230, 59)': 0.35757717831506564}
 Sum pR :  0.357577178315
 Sum pT :  0.642422821685
lseg [137 230]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="o">-</span><span class="mf">31.123950000000001</span><span class="p">,</span> <span class="mf">34.74295</span><span class="p">,</span> <span class="mf">3.6289500000000001</span><span class="p">,</span> <span class="mf">17.468049999999998</span><span class="p">)</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_6_2.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_6_2.png" />
<p>The layout display is fully parameterized via the embedded <strong>display</strong>
dictionnary member of the Layout object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">figsize</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;ednodes&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;WHERE1 Project Office Measurement Site&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;overlay&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">()</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_8_0.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_8_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="o">.</span><span class="n">edges</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="s">&#39;(309, 15, 46)&#39;</span><span class="p">,</span> <span class="s">&#39;(148, 46, 44)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="adding-coordinates-of-transmiting-and-receiving-points">
<h2>20.1. Adding coordinates of transmiting and receiving points<a class="headerlink" href="#adding-coordinates-of-transmiting-and-receiving-points" title="Permalink to this headline">¶</a></h2>
<p>Coordinates of transmitters and receivers for the simulation to be
perform are stotred in <strong>.ini</strong> files. Transmitter and Receiver are
instances of the class <tt class="docutils literal"><span class="pre">RadioNode</span></tt> which offers different methods for
specifying nodes positions. The stucture of this <strong>.ini</strong> file presented
below. The node Id is associated with the 3 coordinates <img class="math" src="../../_images/math/accc80fdf164cef264f56a82b6f9f6add320fe05.png" alt="x,y,z"/>
separated by white spaces.</p>
<div class="highlight-python"><pre>[coordinates]
1 = -12.2724 7.76319999993 1.2
2 = -18.7747 15.1779999998 1.2
3 = -4.14179999998 8.86029999983 1.2
4 = -9.09139999998 15.1899000001 1.2</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">tx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">_fileini</span><span class="o">=</span><span class="s">&#39;w2m1rx.ini&#39;</span><span class="p">,</span><span class="n">_fileant</span><span class="o">=</span><span class="s">&#39;defant.vsh3&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">_fileini</span><span class="o">=</span><span class="s">&#39;w2m1tx.ini&#39;</span><span class="p">,</span><span class="n">_fileant</span><span class="o">=</span><span class="s">&#39;defant.vsh3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The whole simulation setup can then be displayed using the <strong>show</strong>
method of the Simulation object</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Warning : no furniture file loaded</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_15_1.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_15_1.png" />
<p>Select Tx and Rx positions</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="mi">10</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="mi">20</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">26</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
<span class="mi">27</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">29</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">33</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">34</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">35</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span>
      <span class="mi">37</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">38</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">39</span><span class="p">:</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">40</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">41</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">42</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">43</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">44</span><span class="p">:</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">45</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
      <span class="mi">46</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">47</span><span class="p">:</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">48</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">49</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">:</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">53</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
      <span class="mi">55</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">56</span><span class="p">:</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">57</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">58</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">59</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">60</span><span class="p">:</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">61</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">62</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">63</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span>
      <span class="mi">64</span><span class="p">:</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">65</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">66</span><span class="p">:</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">67</span><span class="p">:</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">68</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">69</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">71</span><span class="p">:</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">72</span><span class="p">:</span> <span class="mi">74</span><span class="p">,</span>
      <span class="mi">73</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">74</span><span class="p">:</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">75</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">76</span><span class="p">:</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">77</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">78</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">79</span><span class="p">:</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">80</span><span class="p">:</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">81</span><span class="p">:</span> <span class="mi">83</span><span class="p">,</span>
      <span class="mi">82</span><span class="p">:</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">83</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">84</span><span class="p">:</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">85</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">86</span><span class="p">:</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">87</span><span class="p">:</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">88</span><span class="p">:</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">89</span><span class="p">:</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">90</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span>
      <span class="mi">91</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">92</span><span class="p">:</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">93</span><span class="p">:</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">94</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">95</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">96</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">97</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">98</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">99</span><span class="p">:</span>
      <span class="mi">105</span><span class="p">,</span> <span class="mi">100</span><span class="p">:</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">101</span><span class="p">:</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">102</span><span class="p">:</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">:</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">:</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">105</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">106</span><span class="p">:</span>
      <span class="mi">113</span><span class="p">,</span> <span class="mi">107</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">108</span><span class="p">:</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">109</span><span class="p">:</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">110</span><span class="p">:</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">111</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">112</span><span class="p">:</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">113</span><span class="p">:</span>
      <span class="mi">123</span><span class="p">,</span> <span class="mi">114</span><span class="p">:</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">115</span><span class="p">:</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">116</span><span class="p">:</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">117</span><span class="p">:</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">118</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">119</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">120</span><span class="p">:</span>
      <span class="mi">133</span><span class="p">,</span> <span class="mi">121</span><span class="p">:</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">122</span><span class="p">:</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">123</span><span class="p">:</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">124</span><span class="p">:</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">125</span><span class="p">:</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">126</span><span class="p">:</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">127</span><span class="p">:</span>
      <span class="mi">141</span><span class="p">,</span> <span class="mi">128</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">129</span><span class="p">:</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">130</span><span class="p">:</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">131</span><span class="p">:</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">132</span><span class="p">:</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">133</span><span class="p">:</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">134</span><span class="p">:</span>
      <span class="mi">162</span><span class="p">,</span> <span class="mi">135</span><span class="p">:</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">136</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">137</span><span class="p">:</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">138</span><span class="p">:</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">139</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">140</span><span class="p">:</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">141</span><span class="p">:</span>
      <span class="mi">169</span><span class="p">,</span> <span class="mi">142</span><span class="p">:</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">143</span><span class="p">:</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">144</span><span class="p">:</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">145</span><span class="p">:</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">146</span><span class="p">:</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">147</span><span class="p">:</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">148</span><span class="p">:</span>
      <span class="mi">176</span><span class="p">,</span> <span class="mi">149</span><span class="p">:</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">150</span><span class="p">:</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">151</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">152</span><span class="p">:</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">153</span><span class="p">:</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">154</span><span class="p">:</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">155</span><span class="p">:</span>
      <span class="mi">184</span><span class="p">,</span> <span class="mi">156</span><span class="p">:</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">157</span><span class="p">:</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">158</span><span class="p">:</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">159</span><span class="p">:</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">160</span><span class="p">:</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">161</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">162</span><span class="p">:</span>
      <span class="mi">201</span><span class="p">,</span> <span class="mi">163</span><span class="p">:</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">164</span><span class="p">:</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">165</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">166</span><span class="p">:</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">167</span><span class="p">:</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">168</span><span class="p">:</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">169</span><span class="p">:</span>
      <span class="mi">208</span><span class="p">,</span> <span class="mi">170</span><span class="p">:</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">171</span><span class="p">:</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">172</span><span class="p">:</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">173</span><span class="p">:</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">174</span><span class="p">:</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">175</span><span class="p">:</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">176</span><span class="p">:</span>
      <span class="mi">215</span><span class="p">,</span> <span class="mi">177</span><span class="p">:</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">178</span><span class="p">:</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">179</span><span class="p">:</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">180</span><span class="p">:</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">181</span><span class="p">:</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">182</span><span class="p">:</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">183</span><span class="p">:</span>
      <span class="mi">222</span><span class="p">,</span> <span class="mi">184</span><span class="p">:</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">185</span><span class="p">:</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">186</span><span class="p">:</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">187</span><span class="p">:</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">188</span><span class="p">:</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">189</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">190</span><span class="p">:</span>
      <span class="mi">232</span><span class="p">,</span> <span class="mi">191</span><span class="p">:</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">192</span><span class="p">:</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">193</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">194</span><span class="p">:</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">195</span><span class="p">:</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">196</span><span class="p">:</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">197</span><span class="p">:</span>
      <span class="mi">239</span><span class="p">,</span> <span class="mi">198</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">199</span><span class="p">:</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">201</span><span class="p">:</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">202</span><span class="p">:</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">203</span><span class="p">:</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">204</span><span class="p">:</span>
      <span class="mi">246</span><span class="p">,</span> <span class="mi">205</span><span class="p">:</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">206</span><span class="p">:</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">207</span><span class="p">:</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">208</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">209</span><span class="p">:</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">210</span><span class="p">:</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">211</span><span class="p">:</span>
      <span class="mi">253</span><span class="p">,</span> <span class="mi">212</span><span class="p">:</span> <span class="mi">258</span><span class="p">,</span> <span class="mi">213</span><span class="p">:</span> <span class="mi">259</span><span class="p">,</span> <span class="mi">214</span><span class="p">:</span> <span class="mi">266</span><span class="p">,</span> <span class="mi">215</span><span class="p">:</span> <span class="mi">267</span><span class="p">,</span> <span class="mi">216</span><span class="p">:</span> <span class="mi">268</span><span class="p">,</span> <span class="mi">217</span><span class="p">:</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">218</span><span class="p">:</span>
      <span class="mi">270</span><span class="p">,</span> <span class="mi">219</span><span class="p">:</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">220</span><span class="p">:</span> <span class="mi">272</span><span class="p">,</span> <span class="mi">221</span><span class="p">:</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">222</span><span class="p">:</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">223</span><span class="p">:</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">224</span><span class="p">:</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">225</span><span class="p">:</span>
      <span class="mi">277</span><span class="p">,</span> <span class="mi">226</span><span class="p">:</span> <span class="mi">278</span><span class="p">,</span> <span class="mi">227</span><span class="p">:</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">228</span><span class="p">:</span> <span class="mi">297</span><span class="p">,</span> <span class="mi">229</span><span class="p">:</span> <span class="mi">298</span><span class="p">,</span> <span class="mi">230</span><span class="p">:</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">231</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">232</span><span class="p">:</span>
      <span class="mi">301</span><span class="p">,</span> <span class="mi">233</span><span class="p">:</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">234</span><span class="p">:</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">235</span><span class="p">:</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">236</span><span class="p">:</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">237</span><span class="p">:</span> <span class="mi">306</span><span class="p">,</span> <span class="mi">238</span><span class="p">:</span> <span class="mi">307</span><span class="p">,</span> <span class="mi">239</span><span class="p">:</span>
      <span class="mi">308</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span> <span class="mi">309</span><span class="p">,</span> <span class="mi">241</span><span class="p">:</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">242</span><span class="p">:</span> <span class="mi">311</span><span class="p">,</span> <span class="mi">243</span><span class="p">:</span> <span class="mi">312</span><span class="p">,</span> <span class="mi">244</span><span class="p">:</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">245</span><span class="p">:</span> <span class="mi">314</span><span class="p">,</span> <span class="mi">246</span><span class="p">:</span>
      <span class="mi">315</span><span class="p">,</span> <span class="mi">247</span><span class="p">:</span> <span class="mi">316</span><span class="p">,</span> <span class="mi">248</span><span class="p">:</span> <span class="mi">317</span><span class="p">,</span> <span class="mi">249</span><span class="p">:</span> <span class="mi">318</span><span class="p">,</span> <span class="mi">250</span><span class="p">:</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">251</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">252</span><span class="p">:</span> <span class="mi">321</span><span class="p">,</span> <span class="mi">253</span><span class="p">:</span>
      <span class="mi">322</span><span class="p">,</span> <span class="mi">254</span><span class="p">:</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">255</span><span class="p">:</span> <span class="mi">324</span><span class="p">,</span> <span class="mi">256</span><span class="p">:</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">257</span><span class="p">:</span> <span class="mi">326</span><span class="p">,</span> <span class="mi">258</span><span class="p">:</span> <span class="mi">327</span><span class="p">,</span> <span class="mi">259</span><span class="p">:</span> <span class="mi">328</span><span class="p">,</span> <span class="mi">260</span><span class="p">:</span>
      <span class="mi">329</span><span class="p">,</span> <span class="mi">261</span><span class="p">:</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">262</span><span class="p">:</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">263</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">264</span><span class="p">:</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">265</span><span class="p">:</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">266</span><span class="p">:</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">267</span><span class="p">:</span>
      <span class="mi">337</span><span class="p">,</span> <span class="mi">268</span><span class="p">:</span> <span class="mi">338</span><span class="p">,</span> <span class="mi">269</span><span class="p">:</span> <span class="mi">339</span><span class="p">,</span> <span class="mi">270</span><span class="p">:</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">271</span><span class="p">:</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">272</span><span class="p">:</span> <span class="mi">342</span><span class="p">,</span> <span class="mi">273</span><span class="p">:</span> <span class="mi">343</span><span class="p">,</span> <span class="mi">274</span><span class="p">:</span>
      <span class="mi">344</span><span class="p">,</span> <span class="mi">275</span><span class="p">:</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">276</span><span class="p">:</span> <span class="mi">346</span><span class="p">,</span> <span class="mi">277</span><span class="p">:</span> <span class="mi">347</span><span class="p">,</span> <span class="mi">278</span><span class="p">:</span> <span class="mi">348</span><span class="p">,</span> <span class="mi">279</span><span class="p">:</span> <span class="mi">349</span><span class="p">,</span> <span class="mi">280</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">281</span><span class="p">:</span>
      <span class="mi">351</span><span class="p">,</span> <span class="mi">282</span><span class="p">:</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">283</span><span class="p">:</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">284</span><span class="p">:</span> <span class="mi">354</span><span class="p">,</span> <span class="mi">285</span><span class="p">:</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">286</span><span class="p">:</span> <span class="mi">356</span><span class="p">,</span> <span class="mi">287</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">288</span><span class="p">:</span>
      <span class="mi">361</span><span class="p">,</span> <span class="mi">289</span><span class="p">:</span> <span class="mi">362</span><span class="p">,</span> <span class="mi">290</span><span class="p">:</span> <span class="mi">363</span><span class="p">,</span> <span class="mi">291</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span> <span class="mi">292</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="mi">293</span><span class="p">:</span> <span class="mi">366</span><span class="p">,</span> <span class="mi">294</span><span class="p">:</span> <span class="mi">367</span><span class="p">,</span> <span class="mi">295</span><span class="p">:</span>
      <span class="mi">368</span><span class="p">,</span> <span class="mi">296</span><span class="p">:</span> <span class="mi">369</span><span class="p">,</span> <span class="mi">297</span><span class="p">:</span> <span class="mi">370</span><span class="p">,</span> <span class="mi">298</span><span class="p">:</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">299</span><span class="p">:</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">301</span><span class="p">:</span> <span class="mi">374</span><span class="p">,</span> <span class="mi">302</span><span class="p">:</span>
      <span class="mi">375</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="s">&#39;number of Tx :&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="k">print</span> <span class="s">&#39;number of rx :&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python"><pre>number of Tx : 302
number of rx : 4</pre>
</div>
<p>Choose measurement points</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Chose used points here</span>

<span class="n">itx</span><span class="o">=</span><span class="mi">10</span>
<span class="n">irx</span><span class="o">=</span><span class="mi">2</span>


<span class="c"># check points</span>
<span class="n">tx</span><span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
<span class="n">rx</span><span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">UWBMesure</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">itx</span><span class="p">])</span>
<span class="n">txm</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tx</span>
<span class="n">rxm</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
<span class="k">print</span> <span class="n">tx</span><span class="p">,</span><span class="n">txm</span>
<span class="k">print</span> <span class="n">rx</span><span class="p">,</span><span class="n">rxm</span>

<span class="k">if</span> <span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">txm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">txm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Tx and Txm Are not the same !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span>
<span class="k">else</span> <span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Txs OK&#39;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">rx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">rxm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">rx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rxm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Rx and Rxm Are not the same !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span>
<span class="k">else</span> <span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Rxs OK&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[-24.867   12.3097   1.2   ] [-24.867   12.3097   1.2   ]
[-18.7747  15.178    1.2   ] [-18.7747  15.178    1.2   ]
Txs OK
Rxs OK</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_21_0.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_21_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">M</span><span class="o">.</span><span class="n">tx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;or&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;tx&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;ob&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;rx&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.legend.Legend at 0x9e575d0&gt;</pre>
</div>
</div>
<div class="section" id="signatures-rays-and-channel">
<h2>20.2. Signatures, Rays and channel<a class="headerlink" href="#signatures-rays-and-channel" title="Permalink to this headline">¶</a></h2>
<p>A signature is a sequence of layout objects (points and segments) which
are involved in a given optical ray joinint the transmiter and the
receiver. The signatutre is calculated from a layout cycle to an other
layout cycle. This means that is is required first to retrieve the cycle
number from point coordinates. This is done thanks to the <strong>pt2cy</strong>,
point to cycle function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ctx</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="n">crx</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;tx point belongs to cycle &#39;</span><span class="p">,</span><span class="n">ctx</span>
<span class="k">print</span> <span class="s">&#39;rx point belongs to cycle &#39;</span><span class="p">,</span><span class="n">crx</span>
</pre></div>
</div>
<div class="highlight-python"><pre>tx point belongs to cycle  5
rx point belongs to cycle  4</pre>
</div>
<p>Then the signature between cycle 5 and cycle 4 can be calculated. This
is done by instantiating a Signature object with a given layout and the
2 cycle number.</p>
<p>The representaion of a signature obje</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Si</span> <span class="o">=</span> <span class="n">Signatures</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">)</span>
<span class="n">Si</span><span class="o">.</span><span class="n">run4</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mf">1.5</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">rx</span><span class="p">)</span>
<span class="n">r3d</span><span class="o">=</span><span class="n">r2d</span><span class="o">.</span><span class="n">to3D</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">nodes</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0x8564a50&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x9e57a50&gt;)</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_30_1.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_30_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0xbe54390&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x7fd4f8909450&gt;)</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_31_1.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_31_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">locbas</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">r3d</span><span class="o">.</span><span class="n">fillinter</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">r3d</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Rays3D
----------
1 / 1 : [0]
2 / 5 : [1 2 3 4 5]
3 / 16 : [ 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
4 / 31 : [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
 47 48 49 50 51 52]
5 / 34 : [53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77
 78 79 80 81 82 83 84 85 86]
6 / 18 : [ 87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104]
-----
ni : 461
nl : 1027</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Rays3D
----------
1 / 1 : [0]
2 / 5 : [1 2 3 4 5]
3 / 16 : [ 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
4 / 31 : [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
 47 48 49 50 51 52]
5 / 34 : [53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77
 78 79 80 81 82 83 84 85 86]
6 / 18 : [ 87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104]
-----
ni : 461
nl : 1027</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">freq</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span>  <span class="mf">2.</span>  <span class="p">,</span>   <span class="mf">2.05</span><span class="p">,</span>   <span class="mf">2.1</span> <span class="p">,</span>   <span class="mf">2.15</span><span class="p">,</span>   <span class="mf">2.2</span> <span class="p">,</span>   <span class="mf">2.25</span><span class="p">,</span>   <span class="mf">2.3</span> <span class="p">,</span>   <span class="mf">2.35</span><span class="p">,</span>
         <span class="mf">2.4</span> <span class="p">,</span>   <span class="mf">2.45</span><span class="p">,</span>   <span class="mf">2.5</span> <span class="p">,</span>   <span class="mf">2.55</span><span class="p">,</span>   <span class="mf">2.6</span> <span class="p">,</span>   <span class="mf">2.65</span><span class="p">,</span>   <span class="mf">2.7</span> <span class="p">,</span>   <span class="mf">2.75</span><span class="p">,</span>
         <span class="mf">2.8</span> <span class="p">,</span>   <span class="mf">2.85</span><span class="p">,</span>   <span class="mf">2.9</span> <span class="p">,</span>   <span class="mf">2.95</span><span class="p">,</span>   <span class="mf">3.</span>  <span class="p">,</span>   <span class="mf">3.05</span><span class="p">,</span>   <span class="mf">3.1</span> <span class="p">,</span>   <span class="mf">3.15</span><span class="p">,</span>
         <span class="mf">3.2</span> <span class="p">,</span>   <span class="mf">3.25</span><span class="p">,</span>   <span class="mf">3.3</span> <span class="p">,</span>   <span class="mf">3.35</span><span class="p">,</span>   <span class="mf">3.4</span> <span class="p">,</span>   <span class="mf">3.45</span><span class="p">,</span>   <span class="mf">3.5</span> <span class="p">,</span>   <span class="mf">3.55</span><span class="p">,</span>
         <span class="mf">3.6</span> <span class="p">,</span>   <span class="mf">3.65</span><span class="p">,</span>   <span class="mf">3.7</span> <span class="p">,</span>   <span class="mf">3.75</span><span class="p">,</span>   <span class="mf">3.8</span> <span class="p">,</span>   <span class="mf">3.85</span><span class="p">,</span>   <span class="mf">3.9</span> <span class="p">,</span>   <span class="mf">3.95</span><span class="p">,</span>
         <span class="mf">4.</span>  <span class="p">,</span>   <span class="mf">4.05</span><span class="p">,</span>   <span class="mf">4.1</span> <span class="p">,</span>   <span class="mf">4.15</span><span class="p">,</span>   <span class="mf">4.2</span> <span class="p">,</span>   <span class="mf">4.25</span><span class="p">,</span>   <span class="mf">4.3</span> <span class="p">,</span>   <span class="mf">4.35</span><span class="p">,</span>
         <span class="mf">4.4</span> <span class="p">,</span>   <span class="mf">4.45</span><span class="p">,</span>   <span class="mf">4.5</span> <span class="p">,</span>   <span class="mf">4.55</span><span class="p">,</span>   <span class="mf">4.6</span> <span class="p">,</span>   <span class="mf">4.65</span><span class="p">,</span>   <span class="mf">4.7</span> <span class="p">,</span>   <span class="mf">4.75</span><span class="p">,</span>
         <span class="mf">4.8</span> <span class="p">,</span>   <span class="mf">4.85</span><span class="p">,</span>   <span class="mf">4.9</span> <span class="p">,</span>   <span class="mf">4.95</span><span class="p">,</span>   <span class="mf">5.</span>  <span class="p">,</span>   <span class="mf">5.05</span><span class="p">,</span>   <span class="mf">5.1</span> <span class="p">,</span>   <span class="mf">5.15</span><span class="p">,</span>
         <span class="mf">5.2</span> <span class="p">,</span>   <span class="mf">5.25</span><span class="p">,</span>   <span class="mf">5.3</span> <span class="p">,</span>   <span class="mf">5.35</span><span class="p">,</span>   <span class="mf">5.4</span> <span class="p">,</span>   <span class="mf">5.45</span><span class="p">,</span>   <span class="mf">5.5</span> <span class="p">,</span>   <span class="mf">5.55</span><span class="p">,</span>
         <span class="mf">5.6</span> <span class="p">,</span>   <span class="mf">5.65</span><span class="p">,</span>   <span class="mf">5.7</span> <span class="p">,</span>   <span class="mf">5.75</span><span class="p">,</span>   <span class="mf">5.8</span> <span class="p">,</span>   <span class="mf">5.85</span><span class="p">,</span>   <span class="mf">5.9</span> <span class="p">,</span>   <span class="mf">5.95</span><span class="p">,</span>
         <span class="mf">6.</span>  <span class="p">,</span>   <span class="mf">6.05</span><span class="p">,</span>   <span class="mf">6.1</span> <span class="p">,</span>   <span class="mf">6.15</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">6.25</span><span class="p">,</span>   <span class="mf">6.3</span> <span class="p">,</span>   <span class="mf">6.35</span><span class="p">,</span>
         <span class="mf">6.4</span> <span class="p">,</span>   <span class="mf">6.45</span><span class="p">,</span>   <span class="mf">6.5</span> <span class="p">,</span>   <span class="mf">6.55</span><span class="p">,</span>   <span class="mf">6.6</span> <span class="p">,</span>   <span class="mf">6.65</span><span class="p">,</span>   <span class="mf">6.7</span> <span class="p">,</span>   <span class="mf">6.75</span><span class="p">,</span>
         <span class="mf">6.8</span> <span class="p">,</span>   <span class="mf">6.85</span><span class="p">,</span>   <span class="mf">6.9</span> <span class="p">,</span>   <span class="mf">6.95</span><span class="p">,</span>   <span class="mf">7.</span>  <span class="p">,</span>   <span class="mf">7.05</span><span class="p">,</span>   <span class="mf">7.1</span> <span class="p">,</span>   <span class="mf">7.15</span><span class="p">,</span>
         <span class="mf">7.2</span> <span class="p">,</span>   <span class="mf">7.25</span><span class="p">,</span>   <span class="mf">7.3</span> <span class="p">,</span>   <span class="mf">7.35</span><span class="p">,</span>   <span class="mf">7.4</span> <span class="p">,</span>   <span class="mf">7.45</span><span class="p">,</span>   <span class="mf">7.5</span> <span class="p">,</span>   <span class="mf">7.55</span><span class="p">,</span>
         <span class="mf">7.6</span> <span class="p">,</span>   <span class="mf">7.65</span><span class="p">,</span>   <span class="mf">7.7</span> <span class="p">,</span>   <span class="mf">7.75</span><span class="p">,</span>   <span class="mf">7.8</span> <span class="p">,</span>   <span class="mf">7.85</span><span class="p">,</span>   <span class="mf">7.9</span> <span class="p">,</span>   <span class="mf">7.95</span><span class="p">,</span>
         <span class="mf">8.</span>  <span class="p">,</span>   <span class="mf">8.05</span><span class="p">,</span>   <span class="mf">8.1</span> <span class="p">,</span>   <span class="mf">8.15</span><span class="p">,</span>   <span class="mf">8.2</span> <span class="p">,</span>   <span class="mf">8.25</span><span class="p">,</span>   <span class="mf">8.3</span> <span class="p">,</span>   <span class="mf">8.35</span><span class="p">,</span>
         <span class="mf">8.4</span> <span class="p">,</span>   <span class="mf">8.45</span><span class="p">,</span>   <span class="mf">8.5</span> <span class="p">,</span>   <span class="mf">8.55</span><span class="p">,</span>   <span class="mf">8.6</span> <span class="p">,</span>   <span class="mf">8.65</span><span class="p">,</span>   <span class="mf">8.7</span> <span class="p">,</span>   <span class="mf">8.75</span><span class="p">,</span>
         <span class="mf">8.8</span> <span class="p">,</span>   <span class="mf">8.85</span><span class="p">,</span>   <span class="mf">8.9</span> <span class="p">,</span>   <span class="mf">8.95</span><span class="p">,</span>   <span class="mf">9.</span>  <span class="p">,</span>   <span class="mf">9.05</span><span class="p">,</span>   <span class="mf">9.1</span> <span class="p">,</span>   <span class="mf">9.15</span><span class="p">,</span>
         <span class="mf">9.2</span> <span class="p">,</span>   <span class="mf">9.25</span><span class="p">,</span>   <span class="mf">9.3</span> <span class="p">,</span>   <span class="mf">9.35</span><span class="p">,</span>   <span class="mf">9.4</span> <span class="p">,</span>   <span class="mf">9.45</span><span class="p">,</span>   <span class="mf">9.5</span> <span class="p">,</span>   <span class="mf">9.55</span><span class="p">,</span>
         <span class="mf">9.6</span> <span class="p">,</span>   <span class="mf">9.65</span><span class="p">,</span>   <span class="mf">9.7</span> <span class="p">,</span>   <span class="mf">9.75</span><span class="p">,</span>   <span class="mf">9.8</span> <span class="p">,</span>   <span class="mf">9.85</span><span class="p">,</span>   <span class="mf">9.9</span> <span class="p">,</span>   <span class="mf">9.95</span><span class="p">,</span>
        <span class="mf">10.</span>  <span class="p">,</span>  <span class="mf">10.05</span><span class="p">,</span>  <span class="mf">10.1</span> <span class="p">,</span>  <span class="mf">10.15</span><span class="p">,</span>  <span class="mf">10.2</span> <span class="p">,</span>  <span class="mf">10.25</span><span class="p">,</span>  <span class="mf">10.3</span> <span class="p">,</span>  <span class="mf">10.35</span><span class="p">,</span>
        <span class="mf">10.4</span> <span class="p">,</span>  <span class="mf">10.45</span><span class="p">,</span>  <span class="mf">10.5</span> <span class="p">,</span>  <span class="mf">10.55</span><span class="p">,</span>  <span class="mf">10.6</span> <span class="p">,</span>  <span class="mf">10.65</span><span class="p">,</span>  <span class="mf">10.7</span> <span class="p">,</span>  <span class="mf">10.75</span><span class="p">,</span>
        <span class="mf">10.8</span> <span class="p">,</span>  <span class="mf">10.85</span><span class="p">,</span>  <span class="mf">10.9</span> <span class="p">,</span>  <span class="mf">10.95</span><span class="p">,</span>  <span class="mf">11.</span>  <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span> <span class="o">=</span> <span class="n">r3d</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">freq</span><span class="p">())</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">energy</span></tt> method calculates the energy hoeld by each ray</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">energy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">array</span><span class="p">([</span>  <span class="mf">1.50717866e+00</span><span class="p">,</span>   <span class="mf">8.72383299e-01</span><span class="p">,</span>   <span class="mf">7.43948129e-01</span><span class="p">,</span>
          <span class="mf">5.88602827e-02</span><span class="p">,</span>   <span class="mf">6.49517588e-02</span><span class="p">,</span>   <span class="mf">6.82830760e-02</span><span class="p">,</span>
          <span class="mf">3.54534653e-02</span><span class="p">,</span>   <span class="mf">3.03303816e-02</span><span class="p">,</span>   <span class="mf">8.53310210e-03</span><span class="p">,</span>
          <span class="mf">9.71372168e-03</span><span class="p">,</span>   <span class="mf">1.34329862e-02</span><span class="p">,</span>   <span class="mf">5.11977619e-02</span><span class="p">,</span>
          <span class="mf">1.04359516e-01</span><span class="p">,</span>   <span class="mf">1.37194630e-04</span><span class="p">,</span>   <span class="mf">2.24881173e-04</span><span class="p">,</span>
          <span class="mf">5.56901244e-02</span><span class="p">,</span>   <span class="mf">1.07063235e-03</span><span class="p">,</span>   <span class="mf">5.29425486e-02</span><span class="p">,</span>
          <span class="mf">1.13768704e-03</span><span class="p">,</span>   <span class="mf">8.71270328e-03</span><span class="p">,</span>   <span class="mf">5.41494202e-03</span><span class="p">,</span>
          <span class="mf">9.58557439e-03</span><span class="p">,</span>   <span class="mf">2.79649101e-04</span><span class="p">,</span>   <span class="mf">6.10714650e-04</span><span class="p">,</span>
          <span class="mf">1.10020382e-02</span><span class="p">,</span>   <span class="mf">1.05690665e-02</span><span class="p">,</span>   <span class="mf">1.04372661e-05</span><span class="p">,</span>
          <span class="mf">1.25286783e-04</span><span class="p">,</span>   <span class="mf">6.33948908e-05</span><span class="p">,</span>   <span class="mf">5.87987972e-03</span><span class="p">,</span>
          <span class="mf">1.79390141e-04</span><span class="p">,</span>   <span class="mf">2.29893535e-02</span><span class="p">,</span>   <span class="mf">4.29389287e-05</span><span class="p">,</span>
          <span class="mf">1.00415449e-03</span><span class="p">,</span>   <span class="mf">1.02078797e-03</span><span class="p">,</span>   <span class="mf">6.65003548e-05</span><span class="p">,</span>
          <span class="mf">1.75349689e-06</span><span class="p">,</span>   <span class="mf">1.06828491e-02</span><span class="p">,</span>   <span class="mf">1.18747946e-02</span><span class="p">,</span>
          <span class="mf">1.51969989e-04</span><span class="p">,</span>   <span class="mf">7.50277086e-06</span><span class="p">,</span>   <span class="mf">2.22448129e-04</span><span class="p">,</span>
          <span class="mf">1.01132975e-05</span><span class="p">,</span>   <span class="mf">2.45454222e-04</span><span class="p">,</span>   <span class="mf">1.58291561e-04</span><span class="p">,</span>
          <span class="mf">3.33823329e-04</span><span class="p">,</span>   <span class="mf">2.11439212e-05</span><span class="p">,</span>   <span class="mf">1.09192028e-03</span><span class="p">,</span>
          <span class="mf">2.22112301e-04</span><span class="p">,</span>   <span class="mf">8.56044825e-04</span><span class="p">,</span>   <span class="mf">1.31056176e-03</span><span class="p">,</span>
          <span class="mf">1.02549588e-03</span><span class="p">,</span>   <span class="mf">2.00009116e-03</span><span class="p">,</span>   <span class="mf">1.72815139e-03</span><span class="p">,</span>
          <span class="mf">1.23562630e-03</span><span class="p">,</span>   <span class="mf">5.02095787e-05</span><span class="p">,</span>   <span class="mf">1.14052380e-04</span><span class="p">,</span>
          <span class="mf">8.05219626e-05</span><span class="p">,</span>   <span class="mf">3.28328138e-05</span><span class="p">,</span>   <span class="mf">6.44649760e-05</span><span class="p">,</span>
          <span class="mf">2.29734777e-04</span><span class="p">,</span>   <span class="mf">1.15802974e-04</span><span class="p">,</span>   <span class="mf">1.54155145e-05</span><span class="p">,</span>
          <span class="mf">1.97470536e-04</span><span class="p">,</span>   <span class="mf">1.19146330e-04</span><span class="p">,</span>   <span class="mf">2.16602036e-05</span><span class="p">,</span>
          <span class="mf">1.11553925e-04</span><span class="p">,</span>   <span class="mf">9.69270565e-03</span><span class="p">,</span>   <span class="mf">1.93607601e-03</span><span class="p">,</span>
          <span class="mf">5.93875349e-05</span><span class="p">,</span>   <span class="mf">7.12439444e-03</span><span class="p">,</span>   <span class="mf">9.68028356e-05</span><span class="p">,</span>
          <span class="mf">8.54211894e-05</span><span class="p">,</span>   <span class="mf">3.55405355e-05</span><span class="p">,</span>   <span class="mf">1.24790236e-03</span><span class="p">,</span>
          <span class="mf">2.21022661e-04</span><span class="p">,</span>   <span class="mf">1.75148699e-04</span><span class="p">,</span>   <span class="mf">6.50288223e-05</span><span class="p">,</span>
          <span class="mf">2.91193002e-04</span><span class="p">,</span>   <span class="mf">2.16224248e-03</span><span class="p">,</span>   <span class="mf">2.47123465e-03</span><span class="p">,</span>
          <span class="mf">1.18362263e-03</span><span class="p">,</span>   <span class="mf">5.75388808e-04</span><span class="p">,</span>   <span class="mf">2.91758477e-04</span><span class="p">,</span>
          <span class="mf">5.51046523e-04</span><span class="p">,</span>   <span class="mf">5.98355765e-04</span><span class="p">,</span>   <span class="mf">4.69812489e-04</span><span class="p">,</span>
          <span class="mf">1.51177319e-06</span><span class="p">,</span>   <span class="mf">1.39066087e-05</span><span class="p">,</span>   <span class="mf">2.77314071e-05</span><span class="p">,</span>
          <span class="mf">1.83960091e-04</span><span class="p">,</span>   <span class="mf">2.56338584e-04</span><span class="p">,</span>   <span class="mf">5.32258431e-06</span><span class="p">,</span>
          <span class="mf">5.95554013e-06</span><span class="p">,</span>   <span class="mf">1.32305177e-05</span><span class="p">,</span>   <span class="mf">5.32176083e-05</span><span class="p">,</span>
          <span class="mf">1.11130239e-03</span><span class="p">,</span>   <span class="mf">9.15109095e-05</span><span class="p">,</span>   <span class="mf">1.05832357e-03</span><span class="p">,</span>
          <span class="mf">8.60677065e-04</span><span class="p">,</span>   <span class="mf">8.27197200e-04</span><span class="p">,</span>   <span class="mf">1.54930324e-03</span><span class="p">,</span>
          <span class="mf">6.79953409e-04</span><span class="p">,</span>   <span class="mf">1.30889427e-03</span><span class="p">,</span>   <span class="mf">1.24607050e-03</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">1.29040779e+00</span><span class="p">,</span>   <span class="mf">8.48255132e-02</span><span class="p">,</span>   <span class="mf">1.17476989e-01</span><span class="p">,</span>
          <span class="mf">2.88212748e-01</span><span class="p">,</span>   <span class="mf">6.78736126e-02</span><span class="p">,</span>   <span class="mf">6.91178518e-02</span><span class="p">,</span>
          <span class="mf">1.30831387e-02</span><span class="p">,</span>   <span class="mf">1.71412387e-02</span><span class="p">,</span>   <span class="mf">9.18240805e-03</span><span class="p">,</span>
          <span class="mf">1.26936235e-02</span><span class="p">,</span>   <span class="mf">1.11250612e-02</span><span class="p">,</span>   <span class="mf">3.86908768e-03</span><span class="p">,</span>
          <span class="mf">4.72544843e-03</span><span class="p">,</span>   <span class="mf">3.28379115e-02</span><span class="p">,</span>   <span class="mf">2.59571206e-02</span><span class="p">,</span>
          <span class="mf">6.02854066e-03</span><span class="p">,</span>   <span class="mf">4.65726984e-02</span><span class="p">,</span>   <span class="mf">3.84255807e-03</span><span class="p">,</span>
          <span class="mf">3.70510573e-02</span><span class="p">,</span>   <span class="mf">9.23267268e-03</span><span class="p">,</span>   <span class="mf">5.60971604e-03</span><span class="p">,</span>
          <span class="mf">9.79610884e-03</span><span class="p">,</span>   <span class="mf">3.38476331e-03</span><span class="p">,</span>   <span class="mf">3.30074709e-03</span><span class="p">,</span>
          <span class="mf">4.37291852e-04</span><span class="p">,</span>   <span class="mf">3.28904147e-04</span><span class="p">,</span>   <span class="mf">7.73214589e-04</span><span class="p">,</span>
          <span class="mf">5.37997318e-04</span><span class="p">,</span>   <span class="mf">6.60788727e-04</span><span class="p">,</span>   <span class="mf">2.59344403e-04</span><span class="p">,</span>
          <span class="mf">4.77613852e-04</span><span class="p">,</span>   <span class="mf">6.52446705e-04</span><span class="p">,</span>   <span class="mf">1.19686862e-02</span><span class="p">,</span>
          <span class="mf">4.23869732e-03</span><span class="p">,</span>   <span class="mf">2.67919046e-03</span><span class="p">,</span>   <span class="mf">8.53586068e-04</span><span class="p">,</span>
          <span class="mf">2.59480959e-04</span><span class="p">,</span>   <span class="mf">6.82970439e-05</span><span class="p">,</span>   <span class="mf">1.11026500e-04</span><span class="p">,</span>
          <span class="mf">3.63094187e-03</span><span class="p">,</span>   <span class="mf">7.02005464e-06</span><span class="p">,</span>   <span class="mf">9.49443735e-06</span><span class="p">,</span>
          <span class="mf">6.91037039e-06</span><span class="p">,</span>   <span class="mf">1.98917235e-05</span><span class="p">,</span>   <span class="mf">4.15443320e-03</span><span class="p">,</span>
          <span class="mf">2.83134828e-03</span><span class="p">,</span>   <span class="mf">1.04707561e-05</span><span class="p">,</span>   <span class="mf">7.79799266e-03</span><span class="p">,</span>
          <span class="mf">2.74116760e-05</span><span class="p">,</span>   <span class="mf">9.02423326e-04</span><span class="p">,</span>   <span class="mf">1.35817604e-03</span><span class="p">,</span>
          <span class="mf">1.05432999e-03</span><span class="p">,</span>   <span class="mf">1.98147495e-03</span><span class="p">,</span>   <span class="mf">2.25382366e-04</span><span class="p">,</span>
          <span class="mf">3.13550015e-04</span><span class="p">,</span>   <span class="mf">1.16041899e-06</span><span class="p">,</span>   <span class="mf">3.01617274e-04</span><span class="p">,</span>
          <span class="mf">1.07050148e-03</span><span class="p">,</span>   <span class="mf">2.50402676e-03</span><span class="p">,</span>   <span class="mf">5.86416144e-03</span><span class="p">,</span>
          <span class="mf">2.21046915e-04</span><span class="p">,</span>   <span class="mf">6.98223402e-06</span><span class="p">,</span>   <span class="mf">4.34058789e-05</span><span class="p">,</span>
          <span class="mf">7.46483719e-06</span><span class="p">,</span>   <span class="mf">1.55312397e-04</span><span class="p">,</span>   <span class="mf">4.89785548e-05</span><span class="p">,</span>
          <span class="mf">1.05834613e-04</span><span class="p">,</span>   <span class="mf">3.18005296e-05</span><span class="p">,</span>   <span class="mf">1.39731044e-05</span><span class="p">,</span>
          <span class="mf">3.13832066e-04</span><span class="p">,</span>   <span class="mf">1.65210326e-05</span><span class="p">,</span>   <span class="mf">3.25523335e-04</span><span class="p">,</span>
          <span class="mf">1.47167228e-04</span><span class="p">,</span>   <span class="mf">4.79520767e-05</span><span class="p">,</span>   <span class="mf">7.06827360e-06</span><span class="p">,</span>
          <span class="mf">3.25336068e-04</span><span class="p">,</span>   <span class="mf">7.68029101e-04</span><span class="p">,</span>   <span class="mf">6.99467316e-05</span><span class="p">,</span>
          <span class="mf">1.54317487e-03</span><span class="p">,</span>   <span class="mf">7.57409296e-06</span><span class="p">,</span>   <span class="mf">8.83989381e-06</span><span class="p">,</span>
          <span class="mf">3.15505498e-04</span><span class="p">,</span>   <span class="mf">2.55271187e-03</span><span class="p">,</span>   <span class="mf">9.36639388e-04</span><span class="p">,</span>
          <span class="mf">2.03632807e-03</span><span class="p">,</span>   <span class="mf">1.80256361e-03</span><span class="p">,</span>   <span class="mf">1.72411395e-03</span><span class="p">,</span>
          <span class="mf">1.14694826e-04</span><span class="p">,</span>   <span class="mf">1.07381489e-04</span><span class="p">,</span>   <span class="mf">1.21995072e-06</span><span class="p">,</span>
          <span class="mf">5.13847570e-06</span><span class="p">,</span>   <span class="mf">1.24833836e-05</span><span class="p">,</span>   <span class="mf">1.84052608e-07</span><span class="p">,</span>
          <span class="mf">8.04727851e-07</span><span class="p">,</span>   <span class="mf">2.43500618e-07</span><span class="p">,</span>   <span class="mf">9.40367287e-07</span><span class="p">,</span>
          <span class="mf">2.80292080e-06</span><span class="p">,</span>   <span class="mf">1.50728522e-06</span><span class="p">,</span>   <span class="mf">2.21253510e-06</span><span class="p">,</span>
          <span class="mf">3.99573156e-06</span><span class="p">,</span>   <span class="mf">3.05226608e-06</span><span class="p">,</span>   <span class="mf">1.09471995e-05</span><span class="p">,</span>
          <span class="mf">3.38765449e-06</span><span class="p">,</span>   <span class="mf">1.32603318e-05</span><span class="p">,</span>   <span class="mf">8.71220302e-06</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">5.34880264e-02</span><span class="p">,</span>   <span class="mf">4.60803734e-03</span><span class="p">,</span>   <span class="mf">5.98041544e-03</span><span class="p">,</span>
          <span class="mf">1.48683145e-04</span><span class="p">,</span>   <span class="mf">4.28468974e-07</span><span class="p">,</span>   <span class="mf">1.39167132e-07</span><span class="p">,</span>
          <span class="mf">3.44648117e-04</span><span class="p">,</span>   <span class="mf">4.32988222e-04</span><span class="p">,</span>   <span class="mf">8.24459987e-02</span><span class="p">,</span>
          <span class="mf">7.54576478e-02</span><span class="p">,</span>   <span class="mf">1.63685453e-05</span><span class="p">,</span>   <span class="mf">6.92871619e-05</span><span class="p">,</span>
          <span class="mf">2.63244563e-04</span><span class="p">,</span>   <span class="mf">9.49397775e-06</span><span class="p">,</span>   <span class="mf">2.89314257e-04</span><span class="p">,</span>
          <span class="mf">9.73902592e-06</span><span class="p">,</span>   <span class="mf">1.38493859e-07</span><span class="p">,</span>   <span class="mf">1.72308550e-05</span><span class="p">,</span>
          <span class="mf">2.96402702e-05</span><span class="p">,</span>   <span class="mf">4.06921123e-04</span><span class="p">,</span>   <span class="mf">2.53204898e-04</span><span class="p">,</span>
          <span class="mf">4.45457011e-04</span><span class="p">,</span>   <span class="mf">3.00919230e-03</span><span class="p">,</span>   <span class="mf">2.74214745e-03</span><span class="p">,</span>
          <span class="mf">1.27043571e-03</span><span class="p">,</span>   <span class="mf">1.77472645e-03</span><span class="p">,</span>   <span class="mf">2.52976615e-05</span><span class="p">,</span>
          <span class="mf">3.19583383e-05</span><span class="p">,</span>   <span class="mf">1.26081852e-02</span><span class="p">,</span>   <span class="mf">1.66933899e-03</span><span class="p">,</span>
          <span class="mf">3.01657589e-02</span><span class="p">,</span>   <span class="mf">1.10767500e-05</span><span class="p">,</span>   <span class="mf">1.24368554e-06</span><span class="p">,</span>
          <span class="mf">4.61618831e-05</span><span class="p">,</span>   <span class="mf">7.68465623e-05</span><span class="p">,</span>   <span class="mf">1.24749021e-04</span><span class="p">,</span>
          <span class="mf">9.08952232e-05</span><span class="p">,</span>   <span class="mf">2.04096397e-03</span><span class="p">,</span>   <span class="mf">2.18918090e-03</span><span class="p">,</span>
          <span class="mf">7.27851376e-06</span><span class="p">,</span>   <span class="mf">7.75188889e-03</span><span class="p">,</span>   <span class="mf">7.27374331e-03</span><span class="p">,</span>
          <span class="mf">4.97618361e-03</span><span class="p">,</span>   <span class="mf">1.06649843e-02</span><span class="p">,</span>   <span class="mf">4.76817452e-05</span><span class="p">,</span>
          <span class="mf">5.32268958e-06</span><span class="p">,</span>   <span class="mf">8.83456410e-03</span><span class="p">,</span>   <span class="mf">1.52744749e-04</span><span class="p">,</span>
          <span class="mf">1.34937336e-03</span><span class="p">,</span>   <span class="mf">9.42567084e-09</span><span class="p">,</span>   <span class="mf">7.88070925e-09</span><span class="p">,</span>
          <span class="mf">2.19793421e-09</span><span class="p">,</span>   <span class="mf">1.33811600e-09</span><span class="p">,</span>   <span class="mf">7.65163723e-06</span><span class="p">,</span>
          <span class="mf">1.67915149e-05</span><span class="p">,</span>   <span class="mf">2.31902822e-05</span><span class="p">,</span>   <span class="mf">8.08145175e-06</span><span class="p">,</span>
          <span class="mf">4.54018611e-04</span><span class="p">,</span>   <span class="mf">1.42571737e-04</span><span class="p">,</span>   <span class="mf">4.03665450e-04</span><span class="p">,</span>
          <span class="mf">9.09425612e-06</span><span class="p">,</span>   <span class="mf">1.78502197e-03</span><span class="p">,</span>   <span class="mf">5.39685583e-05</span><span class="p">,</span>
          <span class="mf">2.08133755e-03</span><span class="p">,</span>   <span class="mf">2.09301490e-04</span><span class="p">,</span>   <span class="mf">6.67154780e-05</span><span class="p">,</span>
          <span class="mf">2.47958981e-04</span><span class="p">,</span>   <span class="mf">1.38657691e-05</span><span class="p">,</span>   <span class="mf">1.64801603e-04</span><span class="p">,</span>
          <span class="mf">2.14662346e-03</span><span class="p">,</span>   <span class="mf">6.08350344e-06</span><span class="p">,</span>   <span class="mf">5.80254804e-03</span><span class="p">,</span>
          <span class="mf">2.21523284e-04</span><span class="p">,</span>   <span class="mf">4.03132781e-05</span><span class="p">,</span>   <span class="mf">1.02701914e-04</span><span class="p">,</span>
          <span class="mf">5.50400930e-03</span><span class="p">,</span>   <span class="mf">3.64017129e-07</span><span class="p">,</span>   <span class="mf">1.02301766e-03</span><span class="p">,</span>
          <span class="mf">1.83143792e-05</span><span class="p">,</span>   <span class="mf">2.37637808e-04</span><span class="p">,</span>   <span class="mf">1.98007641e-04</span><span class="p">,</span>
          <span class="mf">3.21570896e-07</span><span class="p">,</span>   <span class="mf">2.47035172e-05</span><span class="p">,</span>   <span class="mf">1.97385201e-07</span><span class="p">,</span>
          <span class="mf">1.87117892e-05</span><span class="p">,</span>   <span class="mf">1.08760771e-06</span><span class="p">,</span>   <span class="mf">1.22245058e-05</span><span class="p">,</span>
          <span class="mf">2.88923701e-05</span><span class="p">,</span>   <span class="mf">1.22816094e-05</span><span class="p">,</span>   <span class="mf">6.13166338e-05</span><span class="p">,</span>
          <span class="mf">2.26194468e-05</span><span class="p">,</span>   <span class="mf">7.90626055e-06</span><span class="p">,</span>   <span class="mf">1.37317342e-05</span><span class="p">,</span>
          <span class="mf">1.22449783e-04</span><span class="p">,</span>   <span class="mf">1.31706875e-05</span><span class="p">,</span>   <span class="mf">2.52453549e-04</span><span class="p">,</span>
          <span class="mf">8.59336275e-07</span><span class="p">,</span>   <span class="mf">2.19348695e-04</span><span class="p">,</span>   <span class="mf">1.04655208e-06</span><span class="p">,</span>
          <span class="mf">2.10670000e-07</span><span class="p">,</span>   <span class="mf">2.22683794e-07</span><span class="p">,</span>   <span class="mf">3.94088500e-07</span><span class="p">,</span>
          <span class="mf">1.90411407e-07</span><span class="p">,</span>   <span class="mf">8.05127406e-08</span><span class="p">,</span>   <span class="mf">9.03272187e-08</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">5.34880264e-02</span><span class="p">,</span>   <span class="mf">4.70253324e-04</span><span class="p">,</span>   <span class="mf">9.53453096e-04</span><span class="p">,</span>
          <span class="mf">3.25606682e-04</span><span class="p">,</span>   <span class="mf">4.28490165e-07</span><span class="p">,</span>   <span class="mf">1.39166488e-07</span><span class="p">,</span>
          <span class="mf">6.58052608e-03</span><span class="p">,</span>   <span class="mf">7.65589396e-03</span><span class="p">,</span>   <span class="mf">8.24459987e-02</span><span class="p">,</span>
          <span class="mf">7.54576478e-02</span><span class="p">,</span>   <span class="mf">8.15320469e-06</span><span class="p">,</span>   <span class="mf">1.70511440e-05</span><span class="p">,</span>
          <span class="mf">5.41592552e-05</span><span class="p">,</span>   <span class="mf">4.98194314e-04</span><span class="p">,</span>   <span class="mf">8.32929767e-06</span><span class="p">,</span>
          <span class="mf">1.97219406e-05</span><span class="p">,</span>   <span class="mf">2.06240611e-06</span><span class="p">,</span>   <span class="mf">3.16796161e-05</span><span class="p">,</span>
          <span class="mf">5.92109220e-04</span><span class="p">,</span>   <span class="mf">4.06915344e-04</span><span class="p">,</span>   <span class="mf">2.53194360e-04</span><span class="p">,</span>
          <span class="mf">4.45457563e-04</span><span class="p">,</span>   <span class="mf">1.01712501e-02</span><span class="p">,</span>   <span class="mf">1.06245290e-02</span><span class="p">,</span>
          <span class="mf">1.12214708e-04</span><span class="p">,</span>   <span class="mf">1.19484728e-04</span><span class="p">,</span>   <span class="mf">1.72028890e-02</span><span class="p">,</span>
          <span class="mf">4.14885260e-02</span><span class="p">,</span>   <span class="mf">2.95876839e-05</span><span class="p">,</span>   <span class="mf">2.65130124e-03</span><span class="p">,</span>
          <span class="mf">4.03814948e-05</span><span class="p">,</span>   <span class="mf">1.04625183e-05</span><span class="p">,</span>   <span class="mf">1.07969229e-06</span><span class="p">,</span>
          <span class="mf">1.20402997e-05</span><span class="p">,</span>   <span class="mf">1.19188861e-05</span><span class="p">,</span>   <span class="mf">2.30644740e-02</span><span class="p">,</span>
          <span class="mf">2.59905782e-02</span><span class="p">,</span>   <span class="mf">1.69084386e-03</span><span class="p">,</span>   <span class="mf">1.70711486e-03</span><span class="p">,</span>
          <span class="mf">1.03146050e-06</span><span class="p">,</span>   <span class="mf">1.02227094e-03</span><span class="p">,</span>   <span class="mf">6.39981720e-04</span><span class="p">,</span>
          <span class="mf">1.01244884e-03</span><span class="p">,</span>   <span class="mf">1.59704915e-03</span><span class="p">,</span>   <span class="mf">1.82803331e-06</span><span class="p">,</span>
          <span class="mf">4.31836935e-05</span><span class="p">,</span>   <span class="mf">1.98386471e-03</span><span class="p">,</span>   <span class="mf">2.05740738e-05</span><span class="p">,</span>
          <span class="mf">8.38930939e-03</span><span class="p">,</span>   <span class="mf">5.47689702e-09</span><span class="p">,</span>   <span class="mf">3.34939470e-09</span><span class="p">,</span>
          <span class="mf">2.87072999e-09</span><span class="p">,</span>   <span class="mf">1.43614814e-09</span><span class="p">,</span>   <span class="mf">7.67176734e-06</span><span class="p">,</span>
          <span class="mf">6.33927227e-05</span><span class="p">,</span>   <span class="mf">1.36598438e-03</span><span class="p">,</span>   <span class="mf">4.69152228e-04</span><span class="p">,</span>
          <span class="mf">3.65816261e-05</span><span class="p">,</span>   <span class="mf">1.96997168e-04</span><span class="p">,</span>   <span class="mf">5.35532355e-04</span><span class="p">,</span>
          <span class="mf">2.97339170e-05</span><span class="p">,</span>   <span class="mf">6.06628498e-05</span><span class="p">,</span>   <span class="mf">1.44729065e-03</span><span class="p">,</span>
          <span class="mf">6.98300846e-05</span><span class="p">,</span>   <span class="mf">4.57851393e-05</span><span class="p">,</span>   <span class="mf">1.71312609e-03</span><span class="p">,</span>
          <span class="mf">5.91728217e-05</span><span class="p">,</span>   <span class="mf">4.27614714e-07</span><span class="p">,</span>   <span class="mf">2.67767172e-04</span><span class="p">,</span>
          <span class="mf">1.85128730e-05</span><span class="p">,</span>   <span class="mf">8.93871167e-08</span><span class="p">,</span>   <span class="mf">3.84234643e-05</span><span class="p">,</span>
          <span class="mf">3.75284889e-04</span><span class="p">,</span>   <span class="mf">2.04557194e-03</span><span class="p">,</span>   <span class="mf">1.05410482e-04</span><span class="p">,</span>
          <span class="mf">1.79143739e-04</span><span class="p">,</span>   <span class="mf">1.80964837e-07</span><span class="p">,</span>   <span class="mf">9.14758218e-04</span><span class="p">,</span>
          <span class="mf">2.13176317e-05</span><span class="p">,</span>   <span class="mf">2.26183135e-04</span><span class="p">,</span>   <span class="mf">1.74356891e-04</span><span class="p">,</span>
          <span class="mf">1.54182553e-07</span><span class="p">,</span>   <span class="mf">2.84784687e-05</span><span class="p">,</span>   <span class="mf">2.85562209e-07</span><span class="p">,</span>
          <span class="mf">1.67352836e-05</span><span class="p">,</span>   <span class="mf">1.50085136e-06</span><span class="p">,</span>   <span class="mf">1.04969768e-05</span><span class="p">,</span>
          <span class="mf">1.76917818e-05</span><span class="p">,</span>   <span class="mf">2.62365597e-05</span><span class="p">,</span>   <span class="mf">8.81455569e-06</span><span class="p">,</span>
          <span class="mf">8.02351625e-07</span><span class="p">,</span>   <span class="mf">2.43210557e-08</span><span class="p">,</span>   <span class="mf">9.31884630e-05</span><span class="p">,</span>
          <span class="mf">7.37771985e-06</span><span class="p">,</span>   <span class="mf">8.43374338e-05</span><span class="p">,</span>   <span class="mf">3.79100648e-05</span><span class="p">,</span>
          <span class="mf">2.51109657e-07</span><span class="p">,</span>   <span class="mf">3.08731683e-05</span><span class="p">,</span>   <span class="mf">3.16445653e-07</span><span class="p">,</span>
          <span class="mf">1.95783318e-07</span><span class="p">,</span>   <span class="mf">2.12930276e-07</span><span class="p">,</span>   <span class="mf">2.53116911e-07</span><span class="p">,</span>
          <span class="mf">1.11909010e-07</span><span class="p">,</span>   <span class="mf">8.11390058e-08</span><span class="p">,</span>   <span class="mf">9.07842766e-08</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="section" id="apply-waveform">
<h2>20.3. Apply waveform<a class="headerlink" href="#apply-waveform" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">freq</span>
<span class="n">sco</span><span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">sca</span><span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;W1offset&#39;</span><span class="p">)</span>
<span class="c">#wav = wvf.Waveform({&#39;type&#39; : &#39;generic&#39;,&#39;band&#39;: 0.499,&#39;fc&#39;: 4.493, &#39;fe&#39;: 100, &#39;thresh&#39;: 3, &#39;tw&#39;: 30})</span>
<span class="n">wav</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_40_0.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_40_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">ciro</span> <span class="o">=</span> <span class="n">sco</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
<span class="n">cira</span> <span class="o">=</span> <span class="n">sca</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ciro</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">u&#39;received waveform without antenna $</span><span class="se">\\</span><span class="s">theta</span><span class="se">\\</span><span class="s">theta$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/usr/local/lib/python2.7/dist-packages/matplotlib/axes.py:4747: UserWarning: No labeled objects found. Use label='...' kwarg on individual plots.
  warnings.warn("No labeled objects found. "</pre>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.text.Text at 0x7fd4f9131b10&gt;</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_42_2.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_42_2.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">cira</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;received waveform with antenna&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.text.Text at 0xe9753d0&gt;</pre>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_43_1.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_43_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="c">#dchan={i:&#39;ch&#39;+str(i) for i in range(1,5)}</span>
<span class="n">dchan</span><span class="o">=</span><span class="p">{}</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch3&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch4&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch1&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch2&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Measurements&quot;</span><span class="p">)</span>
<span class="n">cmd</span><span class="o">=</span><span class="s">&#39;M.tdd.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dchan</span><span class="p">[</span><span class="n">irx</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;.plot(ax=ax1)&#39;</span>
<span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;WHERE1 measurement&#39;</span><span class="p">)</span>
<span class="c">#M.tdd.ch2.plot()</span>
<span class="c"># align for plotting</span>
<span class="c">#ciro.x=ciro.x-ciro.x[0]</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Simulation-with antenna&quot;</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Simulation-with antenna - without noise&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c">#ax3 = fig.add_subplot(313,title=&quot;Simulation-without antenna&quot;,sharex=ax1, sharey=ax1)</span>
<span class="c">#ciro.plot()</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_45_0.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_45_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">v</span> <span class="o">=</span> <span class="n">tx</span><span class="o">-</span><span class="n">rx</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>

<span class="k">print</span> <span class="s">&#39;real delay between tx and rx&#39;</span><span class="p">,</span><span class="n">d</span><span class="o">/</span><span class="mf">0.3</span>
<span class="k">print</span> <span class="s">&#39;simulated first path delay&#39;</span><span class="p">,</span><span class="n">r3d</span><span class="o">.</span><span class="n">delays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><pre>real delay between tx and rx 22.4680672606
simulated first path delay 22.4680672606</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">delays</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span>  <span class="mf">22.46806726</span><span class="p">,</span>   <span class="mf">24.18292882</span><span class="p">,</span>   <span class="mf">24.99628065</span><span class="p">,</span>   <span class="mf">25.87437157</span><span class="p">,</span>
         <span class="mf">42.95559158</span><span class="p">,</span>   <span class="mf">51.79056452</span><span class="p">,</span>   <span class="mf">27.37668906</span><span class="p">,</span>   <span class="mf">28.09774198</span><span class="p">,</span>
         <span class="mf">29.40772086</span><span class="p">,</span>   <span class="mf">30.73782761</span><span class="p">,</span>   <span class="mf">41.71071752</span><span class="p">,</span>   <span class="mf">43.87690563</span><span class="p">,</span>
         <span class="mf">44.3303829</span> <span class="p">,</span>   <span class="mf">44.83132695</span><span class="p">,</span>   <span class="mf">45.78534275</span><span class="p">,</span>   <span class="mf">52.55723141</span><span class="p">,</span>
         <span class="mf">52.83546805</span><span class="p">,</span>   <span class="mf">52.93640121</span><span class="p">,</span>   <span class="mf">53.35513533</span><span class="p">,</span>   <span class="mf">57.24533827</span><span class="p">,</span>
         <span class="mf">73.04881379</span><span class="p">,</span>   <span class="mf">77.74128409</span><span class="p">,</span>   <span class="mf">32.08555912</span><span class="p">,</span>   <span class="mf">33.30890428</span><span class="p">,</span>
         <span class="mf">42.65892586</span><span class="p">,</span>   <span class="mf">43.12521253</span><span class="p">,</span>   <span class="mf">45.714854</span>  <span class="p">,</span>   <span class="mf">46.15027493</span><span class="p">,</span>
         <span class="mf">46.65080504</span><span class="p">,</span>   <span class="mf">46.95937444</span><span class="p">,</span>   <span class="mf">47.07757014</span><span class="p">,</span>   <span class="mf">47.80358614</span><span class="p">,</span>
         <span class="mf">48.77327119</span><span class="p">,</span>   <span class="mf">53.58718769</span><span class="p">,</span>   <span class="mf">53.95912049</span><span class="p">,</span>   <span class="mf">54.09963462</span><span class="p">,</span>
         <span class="mf">54.46806832</span><span class="p">,</span>   <span class="mf">55.15670923</span><span class="p">,</span>   <span class="mf">55.87720978</span><span class="p">,</span>   <span class="mf">56.27546336</span><span class="p">,</span>
         <span class="mf">57.93987188</span><span class="p">,</span>   <span class="mf">58.28403515</span><span class="p">,</span>   <span class="mf">73.59435574</span><span class="p">,</span>   <span class="mf">73.8656158</span> <span class="p">,</span>
         <span class="mf">74.74796992</span><span class="p">,</span>   <span class="mf">75.18892262</span><span class="p">,</span>   <span class="mf">78.25411972</span><span class="p">,</span>   <span class="mf">78.44138572</span><span class="p">,</span>
         <span class="mf">78.50928131</span><span class="p">,</span>   <span class="mf">78.54342153</span><span class="p">,</span>   <span class="mf">87.50257849</span><span class="p">,</span>   <span class="mf">99.12940895</span><span class="p">,</span>
        <span class="mf">104.69401317</span><span class="p">,</span>   <span class="mf">45.82339965</span><span class="p">,</span>   <span class="mf">46.68815648</span><span class="p">,</span>   <span class="mf">48.68108335</span><span class="p">,</span>
         <span class="mf">49.49593798</span><span class="p">,</span>   <span class="mf">49.56104933</span><span class="p">,</span>   <span class="mf">49.58661092</span><span class="p">,</span>   <span class="mf">49.98831846</span><span class="p">,</span>
         <span class="mf">50.36166807</span><span class="p">,</span>   <span class="mf">56.13899433</span><span class="p">,</span>   <span class="mf">56.62835391</span><span class="p">,</span>   <span class="mf">56.8470464</span> <span class="p">,</span>
         <span class="mf">56.9818197</span> <span class="p">,</span>   <span class="mf">57.33036252</span><span class="p">,</span>   <span class="mf">57.33173446</span><span class="p">,</span>   <span class="mf">60.30778352</span><span class="p">,</span>
         <span class="mf">60.96744011</span><span class="p">,</span>   <span class="mf">75.28119956</span><span class="p">,</span>   <span class="mf">75.47270498</span><span class="p">,</span>   <span class="mf">75.54640301</span><span class="p">,</span>
         <span class="mf">75.71904704</span><span class="p">,</span>   <span class="mf">75.98272228</span><span class="p">,</span>   <span class="mf">76.00084997</span><span class="p">,</span>   <span class="mf">78.9496738</span> <span class="p">,</span>
         <span class="mf">79.05105354</span><span class="p">,</span>   <span class="mf">79.20259461</span><span class="p">,</span>   <span class="mf">79.30365102</span><span class="p">,</span>   <span class="mf">80.02316697</span><span class="p">,</span>
         <span class="mf">80.52147075</span><span class="p">,</span>   <span class="mf">87.95852001</span><span class="p">,</span>   <span class="mf">88.18560678</span><span class="p">,</span>   <span class="mf">99.53210396</span><span class="p">,</span>
         <span class="mf">99.73284172</span><span class="p">,</span>  <span class="mf">105.07538433</span><span class="p">,</span>  <span class="mf">105.26555179</span><span class="p">,</span>   <span class="mf">52.33385121</span><span class="p">,</span>
         <span class="mf">53.09267353</span><span class="p">,</span>   <span class="mf">59.38794302</span><span class="p">,</span>   <span class="mf">60.05770372</span><span class="p">,</span>   <span class="mf">77.11847384</span><span class="p">,</span>
         <span class="mf">77.54594822</span><span class="p">,</span>   <span class="mf">77.63542367</span><span class="p">,</span>   <span class="mf">78.06006716</span><span class="p">,</span>   <span class="mf">80.70347572</span><span class="p">,</span>
         <span class="mf">80.80265506</span><span class="p">,</span>   <span class="mf">81.19760461</span><span class="p">,</span>   <span class="mf">81.29618112</span><span class="p">,</span>   <span class="mf">89.53603321</span><span class="p">,</span>
         <span class="mf">89.98167171</span><span class="p">,</span>  <span class="mf">100.92888446</span><span class="p">,</span>  <span class="mf">101.32442804</span><span class="p">,</span>  <span class="mf">106.39941914</span><span class="p">,</span>
        <span class="mf">106.77469922</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>-------------------------
Informations of ray # 0
-------------------------

Index , type, slab      , th(rad), alpha     , gamma2
    0 , B0  , -         , -      , -         , -
    0 , T   , PARTITION ,    0.43,  (0.35+0j),  (0.88+0j)
    0 , B   , -         , -      , -         , -

----------------------------------------
 Matrix of ray # 0 at f= 2.0
----------------------------------------
rotation matrix# type: B0
[[-0.99533359 -0.09649373]
 [ 0.09649373 -0.99533359]]
interaction # 0 type: T
[[ 0.29697185+0.47269683j  0.00000000+0.j        ]
 [ 0.00000000+0.j          0.34443500+0.50490218j]]
rotation matrix# [0] type: B
[[ 0.99533359  0.09649373]
 [-0.09649373  0.99533359]]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">doadod</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">))</span>
</pre></div>
</div>
<img alt="./DEV-RayTracingW1_files/DEV-RayTracingW1_49_0.png" src="./DEV-RayTracingW1_files/DEV-RayTracingW1_49_0.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="DOC-RayTracing2.html" title="21. Example of an UWB channel Ray Tracing simulation"
             >next</a></li>
        <li class="right" >
          <a href="../4-signal/UwbWaveforms.html" title="13. Synthesis of Ultra Wide Band Waveforms"
             >previous</a> |</li>
        <li><a href="../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../index.html" >User Manual</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, PyLayers developer team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_setDomainName', 'pylayers.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })(); 
</script> 
 
  </body>
</html>