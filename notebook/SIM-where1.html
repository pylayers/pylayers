<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Simulation Creation &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../index.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../index.html"><img src="../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Simulation Creation</a><ul>
<li><a class="reference internal" href="#adding-coordinates-of-transmiting-and-receiving-points">Adding coordinates of transmiting and receiving points</a></li>
<li><a class="reference internal" href="#signatures-rays-and-channel">Signatures, Rays and channel</a></li>
<li><a class="reference internal" href="#apply-waveform">Apply waveform</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="simulation-creation">
<h1>Simulation Creation<a class="headerlink" href="#simulation-creation" title="Permalink to this headline">¶</a></h1>
<p>A ray-tracing simulation is controlled via a configuration file which is
stored in the <em>ini</em> directory of the project directory. By default,
there is a default configuration file named <strong>default.ini</strong>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pylayers.simul.simulem</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.rays</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.channel</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.signature</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.measures.mesuwb</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">import</span> <span class="nn">pylayers.signal.bsignal</span> <span class="kn">as</span> <span class="nn">bs</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/usr/local/lib/python2.7/dist-packages/pkg_resources.py:991: UserWarning: /home/uguen/.python-eggs is writable by group/others and vulnerable to attack when used with get_resource_filename. Consider a more secure location (set with .set_extraction_path or the PYTHON_EGG_CACHE environment variable).
  warnings.warn(msg, UserWarning)</pre>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.figure.Figure at 0x3ee9dd0&gt;</pre>
</div>
<p>A first step consists in loading a layout associated with the
simulation. Here the <tt class="docutils literal"><span class="pre">WHERE1.ini</span></tt> layout is chosen along with the
corresponding slabs and materials.</p>
<p>This layout corresponds to the office building where the first WHERE1
UWB measurement campaign has been conducted.</p>
<p>The layout method loads those in a member layout object <strong>L</strong> of the
simulation object <strong>S</strong>.</p>
<p>If not already available, the layout associated graphs are built.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span> <span class="o">=</span> <span class="n">Simul</span><span class="p">()</span>
<span class="c"># loading a layout</span>
<span class="n">filestr</span> <span class="o">=</span> <span class="s">&#39;WHERE1&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">filestr</span><span class="o">+</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span><span class="s">&#39;matDB.ini&#39;</span><span class="p">,</span><span class="s">&#39;slabDB.ini&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">dumpr</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">dumpw</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0x3ef50d0&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x5327790&gt;)</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_5_1.png" src="./SIM-where1_files/SIM-where1_5_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">figsize</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGi</span><span class="p">(</span><span class="n">en</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>int0 :  (309, 15, 46)
int1 :  (202, 46, 59)
 output  {'(137, 59, 58)': 0.64242282168494413, '(230, 59, 67)': 0.35757717831506564, '(230, 59)': 0.35757717831506564}
 Sum pR :  0.357577178315
 Sum pT :  0.642422821685
lseg [137 230]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="o">-</span><span class="mf">31.123950000000001</span><span class="p">,</span> <span class="mf">34.74295</span><span class="p">,</span> <span class="mf">3.6289500000000001</span><span class="p">,</span> <span class="mf">17.468049999999998</span><span class="p">)</span>
</pre></div>
</div>
<img alt="./SIM-where1_files/SIM-where1_6_2.png" src="./SIM-where1_files/SIM-where1_6_2.png" />
<p>The layout display is fully parameterized via the embedded <strong>display</strong>
dictionnary member of the Layout object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">figsize</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;ednodes&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;WHERE1 Project Office Measurement Site&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;overlay&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">()</span>
</pre></div>
</div>
<img alt="./SIM-where1_files/SIM-where1_8_0.png" src="./SIM-where1_files/SIM-where1_8_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="o">.</span><span class="n">edges</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="s">&#39;(309, 15, 46)&#39;</span><span class="p">,</span> <span class="s">&#39;(148, 46, 44)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="adding-coordinates-of-transmiting-and-receiving-points">
<h2>Adding coordinates of transmiting and receiving points<a class="headerlink" href="#adding-coordinates-of-transmiting-and-receiving-points" title="Permalink to this headline">¶</a></h2>
<p>Coordinates of transmitters and receivers for the simulation to be
perform are stotred in <strong>.ini</strong> files. Transmitter and Receiver are
instances of the class <tt class="docutils literal"><span class="pre">RadioNode</span></tt> which offers different methods for
specifying nodes positions. The stucture of this <strong>.ini</strong> file presented
below. The node Id is associated with the 3 coordinates <img class="math" src="../_images/math/accc80fdf164cef264f56a82b6f9f6add320fe05.png" alt="x,y,z"/>
separated by white spaces.</p>
<div class="highlight-python"><pre>[coordinates]
1 = -12.2724 7.76319999993 1.2
2 = -18.7747 15.1779999998 1.2
3 = -4.14179999998 8.86029999983 1.2
4 = -9.09139999998 15.1899000001 1.2</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">tx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">_fileini</span><span class="o">=</span><span class="s">&#39;w2m1rx.ini&#39;</span><span class="p">,</span><span class="n">_fileant</span><span class="o">=</span><span class="s">&#39;defant.vsh3&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">_fileini</span><span class="o">=</span><span class="s">&#39;w2m1tx.ini&#39;</span><span class="p">,</span><span class="n">_fileant</span><span class="o">=</span><span class="s">&#39;defant.vsh3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The whole simulation setup can then be displayed using the <strong>show</strong>
method of the Simulation object</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Warning : no furniture file loaded</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_15_1.png" src="./SIM-where1_files/SIM-where1_15_1.png" />
<p>Select Tx and Rx positions</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="mi">10</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="mi">20</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">26</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
<span class="mi">27</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">29</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">33</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">34</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">35</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span>
      <span class="mi">37</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">38</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">39</span><span class="p">:</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">40</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">41</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">42</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">43</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">44</span><span class="p">:</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">45</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
      <span class="mi">46</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">47</span><span class="p">:</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">48</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">49</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">:</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">53</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
      <span class="mi">55</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">56</span><span class="p">:</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">57</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">58</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">59</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">60</span><span class="p">:</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">61</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">62</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">63</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span>
      <span class="mi">64</span><span class="p">:</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">65</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">66</span><span class="p">:</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">67</span><span class="p">:</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">68</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">69</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">71</span><span class="p">:</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">72</span><span class="p">:</span> <span class="mi">74</span><span class="p">,</span>
      <span class="mi">73</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">74</span><span class="p">:</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">75</span><span class="p">:</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">76</span><span class="p">:</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">77</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">78</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">79</span><span class="p">:</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">80</span><span class="p">:</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">81</span><span class="p">:</span> <span class="mi">83</span><span class="p">,</span>
      <span class="mi">82</span><span class="p">:</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">83</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">84</span><span class="p">:</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">85</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">86</span><span class="p">:</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">87</span><span class="p">:</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">88</span><span class="p">:</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">89</span><span class="p">:</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">90</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span>
      <span class="mi">91</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">92</span><span class="p">:</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">93</span><span class="p">:</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">94</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">95</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">96</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">97</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">98</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">99</span><span class="p">:</span>
      <span class="mi">105</span><span class="p">,</span> <span class="mi">100</span><span class="p">:</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">101</span><span class="p">:</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">102</span><span class="p">:</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">:</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">:</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">105</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">106</span><span class="p">:</span>
      <span class="mi">113</span><span class="p">,</span> <span class="mi">107</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">108</span><span class="p">:</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">109</span><span class="p">:</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">110</span><span class="p">:</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">111</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">112</span><span class="p">:</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">113</span><span class="p">:</span>
      <span class="mi">123</span><span class="p">,</span> <span class="mi">114</span><span class="p">:</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">115</span><span class="p">:</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">116</span><span class="p">:</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">117</span><span class="p">:</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">118</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">119</span><span class="p">:</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">120</span><span class="p">:</span>
      <span class="mi">133</span><span class="p">,</span> <span class="mi">121</span><span class="p">:</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">122</span><span class="p">:</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">123</span><span class="p">:</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">124</span><span class="p">:</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">125</span><span class="p">:</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">126</span><span class="p">:</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">127</span><span class="p">:</span>
      <span class="mi">141</span><span class="p">,</span> <span class="mi">128</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">129</span><span class="p">:</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">130</span><span class="p">:</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">131</span><span class="p">:</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">132</span><span class="p">:</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">133</span><span class="p">:</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">134</span><span class="p">:</span>
      <span class="mi">162</span><span class="p">,</span> <span class="mi">135</span><span class="p">:</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">136</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">137</span><span class="p">:</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">138</span><span class="p">:</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">139</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">140</span><span class="p">:</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">141</span><span class="p">:</span>
      <span class="mi">169</span><span class="p">,</span> <span class="mi">142</span><span class="p">:</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">143</span><span class="p">:</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">144</span><span class="p">:</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">145</span><span class="p">:</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">146</span><span class="p">:</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">147</span><span class="p">:</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">148</span><span class="p">:</span>
      <span class="mi">176</span><span class="p">,</span> <span class="mi">149</span><span class="p">:</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">150</span><span class="p">:</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">151</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">152</span><span class="p">:</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">153</span><span class="p">:</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">154</span><span class="p">:</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">155</span><span class="p">:</span>
      <span class="mi">184</span><span class="p">,</span> <span class="mi">156</span><span class="p">:</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">157</span><span class="p">:</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">158</span><span class="p">:</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">159</span><span class="p">:</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">160</span><span class="p">:</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">161</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">162</span><span class="p">:</span>
      <span class="mi">201</span><span class="p">,</span> <span class="mi">163</span><span class="p">:</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">164</span><span class="p">:</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">165</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">166</span><span class="p">:</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">167</span><span class="p">:</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">168</span><span class="p">:</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">169</span><span class="p">:</span>
      <span class="mi">208</span><span class="p">,</span> <span class="mi">170</span><span class="p">:</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">171</span><span class="p">:</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">172</span><span class="p">:</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">173</span><span class="p">:</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">174</span><span class="p">:</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">175</span><span class="p">:</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">176</span><span class="p">:</span>
      <span class="mi">215</span><span class="p">,</span> <span class="mi">177</span><span class="p">:</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">178</span><span class="p">:</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">179</span><span class="p">:</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">180</span><span class="p">:</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">181</span><span class="p">:</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">182</span><span class="p">:</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">183</span><span class="p">:</span>
      <span class="mi">222</span><span class="p">,</span> <span class="mi">184</span><span class="p">:</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">185</span><span class="p">:</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">186</span><span class="p">:</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">187</span><span class="p">:</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">188</span><span class="p">:</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">189</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">190</span><span class="p">:</span>
      <span class="mi">232</span><span class="p">,</span> <span class="mi">191</span><span class="p">:</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">192</span><span class="p">:</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">193</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">194</span><span class="p">:</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">195</span><span class="p">:</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">196</span><span class="p">:</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">197</span><span class="p">:</span>
      <span class="mi">239</span><span class="p">,</span> <span class="mi">198</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">199</span><span class="p">:</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">201</span><span class="p">:</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">202</span><span class="p">:</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">203</span><span class="p">:</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">204</span><span class="p">:</span>
      <span class="mi">246</span><span class="p">,</span> <span class="mi">205</span><span class="p">:</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">206</span><span class="p">:</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">207</span><span class="p">:</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">208</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">209</span><span class="p">:</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">210</span><span class="p">:</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">211</span><span class="p">:</span>
      <span class="mi">253</span><span class="p">,</span> <span class="mi">212</span><span class="p">:</span> <span class="mi">258</span><span class="p">,</span> <span class="mi">213</span><span class="p">:</span> <span class="mi">259</span><span class="p">,</span> <span class="mi">214</span><span class="p">:</span> <span class="mi">266</span><span class="p">,</span> <span class="mi">215</span><span class="p">:</span> <span class="mi">267</span><span class="p">,</span> <span class="mi">216</span><span class="p">:</span> <span class="mi">268</span><span class="p">,</span> <span class="mi">217</span><span class="p">:</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">218</span><span class="p">:</span>
      <span class="mi">270</span><span class="p">,</span> <span class="mi">219</span><span class="p">:</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">220</span><span class="p">:</span> <span class="mi">272</span><span class="p">,</span> <span class="mi">221</span><span class="p">:</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">222</span><span class="p">:</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">223</span><span class="p">:</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">224</span><span class="p">:</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">225</span><span class="p">:</span>
      <span class="mi">277</span><span class="p">,</span> <span class="mi">226</span><span class="p">:</span> <span class="mi">278</span><span class="p">,</span> <span class="mi">227</span><span class="p">:</span> <span class="mi">279</span><span class="p">,</span> <span class="mi">228</span><span class="p">:</span> <span class="mi">297</span><span class="p">,</span> <span class="mi">229</span><span class="p">:</span> <span class="mi">298</span><span class="p">,</span> <span class="mi">230</span><span class="p">:</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">231</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">232</span><span class="p">:</span>
      <span class="mi">301</span><span class="p">,</span> <span class="mi">233</span><span class="p">:</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">234</span><span class="p">:</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">235</span><span class="p">:</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">236</span><span class="p">:</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">237</span><span class="p">:</span> <span class="mi">306</span><span class="p">,</span> <span class="mi">238</span><span class="p">:</span> <span class="mi">307</span><span class="p">,</span> <span class="mi">239</span><span class="p">:</span>
      <span class="mi">308</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span> <span class="mi">309</span><span class="p">,</span> <span class="mi">241</span><span class="p">:</span> <span class="mi">310</span><span class="p">,</span> <span class="mi">242</span><span class="p">:</span> <span class="mi">311</span><span class="p">,</span> <span class="mi">243</span><span class="p">:</span> <span class="mi">312</span><span class="p">,</span> <span class="mi">244</span><span class="p">:</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">245</span><span class="p">:</span> <span class="mi">314</span><span class="p">,</span> <span class="mi">246</span><span class="p">:</span>
      <span class="mi">315</span><span class="p">,</span> <span class="mi">247</span><span class="p">:</span> <span class="mi">316</span><span class="p">,</span> <span class="mi">248</span><span class="p">:</span> <span class="mi">317</span><span class="p">,</span> <span class="mi">249</span><span class="p">:</span> <span class="mi">318</span><span class="p">,</span> <span class="mi">250</span><span class="p">:</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">251</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">252</span><span class="p">:</span> <span class="mi">321</span><span class="p">,</span> <span class="mi">253</span><span class="p">:</span>
      <span class="mi">322</span><span class="p">,</span> <span class="mi">254</span><span class="p">:</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">255</span><span class="p">:</span> <span class="mi">324</span><span class="p">,</span> <span class="mi">256</span><span class="p">:</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">257</span><span class="p">:</span> <span class="mi">326</span><span class="p">,</span> <span class="mi">258</span><span class="p">:</span> <span class="mi">327</span><span class="p">,</span> <span class="mi">259</span><span class="p">:</span> <span class="mi">328</span><span class="p">,</span> <span class="mi">260</span><span class="p">:</span>
      <span class="mi">329</span><span class="p">,</span> <span class="mi">261</span><span class="p">:</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">262</span><span class="p">:</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">263</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">264</span><span class="p">:</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">265</span><span class="p">:</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">266</span><span class="p">:</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">267</span><span class="p">:</span>
      <span class="mi">337</span><span class="p">,</span> <span class="mi">268</span><span class="p">:</span> <span class="mi">338</span><span class="p">,</span> <span class="mi">269</span><span class="p">:</span> <span class="mi">339</span><span class="p">,</span> <span class="mi">270</span><span class="p">:</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">271</span><span class="p">:</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">272</span><span class="p">:</span> <span class="mi">342</span><span class="p">,</span> <span class="mi">273</span><span class="p">:</span> <span class="mi">343</span><span class="p">,</span> <span class="mi">274</span><span class="p">:</span>
      <span class="mi">344</span><span class="p">,</span> <span class="mi">275</span><span class="p">:</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">276</span><span class="p">:</span> <span class="mi">346</span><span class="p">,</span> <span class="mi">277</span><span class="p">:</span> <span class="mi">347</span><span class="p">,</span> <span class="mi">278</span><span class="p">:</span> <span class="mi">348</span><span class="p">,</span> <span class="mi">279</span><span class="p">:</span> <span class="mi">349</span><span class="p">,</span> <span class="mi">280</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">281</span><span class="p">:</span>
      <span class="mi">351</span><span class="p">,</span> <span class="mi">282</span><span class="p">:</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">283</span><span class="p">:</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">284</span><span class="p">:</span> <span class="mi">354</span><span class="p">,</span> <span class="mi">285</span><span class="p">:</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">286</span><span class="p">:</span> <span class="mi">356</span><span class="p">,</span> <span class="mi">287</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">288</span><span class="p">:</span>
      <span class="mi">361</span><span class="p">,</span> <span class="mi">289</span><span class="p">:</span> <span class="mi">362</span><span class="p">,</span> <span class="mi">290</span><span class="p">:</span> <span class="mi">363</span><span class="p">,</span> <span class="mi">291</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span> <span class="mi">292</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="mi">293</span><span class="p">:</span> <span class="mi">366</span><span class="p">,</span> <span class="mi">294</span><span class="p">:</span> <span class="mi">367</span><span class="p">,</span> <span class="mi">295</span><span class="p">:</span>
      <span class="mi">368</span><span class="p">,</span> <span class="mi">296</span><span class="p">:</span> <span class="mi">369</span><span class="p">,</span> <span class="mi">297</span><span class="p">:</span> <span class="mi">370</span><span class="p">,</span> <span class="mi">298</span><span class="p">:</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">299</span><span class="p">:</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">301</span><span class="p">:</span> <span class="mi">374</span><span class="p">,</span> <span class="mi">302</span><span class="p">:</span>
      <span class="mi">375</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="s">&#39;number of Tx :&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="k">print</span> <span class="s">&#39;number of rx :&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python"><pre>number of Tx : 302
number of rx : 4</pre>
</div>
<p>Choose measurement points</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Chose used points here</span>

<span class="n">itx</span><span class="o">=</span><span class="mi">10</span>
<span class="n">irx</span><span class="o">=</span><span class="mi">2</span>


<span class="c"># check points</span>
<span class="n">tx</span><span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
<span class="n">rx</span><span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">UWBMesure</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">itx</span><span class="p">])</span>
<span class="n">txm</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tx</span>
<span class="n">rxm</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
<span class="k">print</span> <span class="n">tx</span><span class="p">,</span><span class="n">txm</span>
<span class="k">print</span> <span class="n">rx</span><span class="p">,</span><span class="n">rxm</span>

<span class="k">if</span> <span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">txm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">txm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Tx and Txm Are not the same !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span>
<span class="k">else</span> <span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Txs OK&#39;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">rx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">rxm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">rx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rxm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Rx and Rxm Are not the same !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span>
<span class="k">else</span> <span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Rxs OK&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[-24.867   12.3097   1.2   ] [-24.867   12.3097   1.2   ]
[-18.7747  15.178    1.2   ] [-18.7747  15.178    1.2   ]
Txs OK
Rxs OK</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="./SIM-where1_files/SIM-where1_21_0.png" src="./SIM-where1_files/SIM-where1_21_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">M</span><span class="o">.</span><span class="n">tx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;or&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;tx&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">M</span><span class="o">.</span><span class="n">rx</span><span class="p">[</span><span class="n">irx</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;ob&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;rx&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.legend.Legend at 0x985e1d0&gt;</pre>
</div>
</div>
<div class="section" id="signatures-rays-and-channel">
<h2>Signatures, Rays and channel<a class="headerlink" href="#signatures-rays-and-channel" title="Permalink to this headline">¶</a></h2>
<p>A signature is a sequence of layout objects (points and segments) which
are involved in a given optical ray joinint the transmiter and the
receiver. The signatutre is calculated from a layout cycle to an other
layout cycle. This means that is is required first to retrieve the cycle
number from point coordinates. This is done thanks to the <strong>pt2cy</strong>,
point to cycle function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ctx</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="n">crx</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;tx point belongs to cycle &#39;</span><span class="p">,</span><span class="n">ctx</span>
<span class="k">print</span> <span class="s">&#39;rx point belongs to cycle &#39;</span><span class="p">,</span><span class="n">crx</span>
</pre></div>
</div>
<div class="highlight-python"><pre>tx point belongs to cycle  5
rx point belongs to cycle  4</pre>
</div>
<p>Then the signature between cycle 5 and cycle 4 can be calculated. This
is done by instantiating a Signature object with a given layout and the
2 cycle number.</p>
<p>The representaion of a signature obje</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Si</span> <span class="o">=</span> <span class="n">Signatures</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">)</span>
<span class="n">Si</span><span class="o">.</span><span class="n">run4</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mf">1.5</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">rx</span><span class="p">)</span>
<span class="n">r3d</span><span class="o">=</span><span class="n">r2d</span><span class="o">.</span><span class="n">to3D</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">nodes</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0x9361f50&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x9364610&gt;)</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_30_1.png" src="./SIM-where1_files/SIM-where1_30_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">r2d</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0x986ce10&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0x8656410&gt;)</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_31_1.png" src="./SIM-where1_files/SIM-where1_31_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">locbas</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">r3d</span><span class="o">.</span><span class="n">fillinter</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">r3d</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Rays3D
----------
1 / 1 : [0]
2 / 5 : [1 2 3 4 5]
3 / 16 : [ 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
4 / 30 : [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
 47 48 49 50 51]
5 / 32 : [52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76
 77 78 79 80 81 82 83]
6 / 16 : [84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99]
-----
ni : 435
nl : 970</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Rays3D
----------
1 / 1 : [0]
2 / 5 : [1 2 3 4 5]
3 / 16 : [ 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
4 / 30 : [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
 47 48 49 50 51]
5 / 32 : [52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76
 77 78 79 80 81 82 83]
6 / 16 : [84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99]
-----
ni : 435
nl : 970</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">freq</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span>  <span class="mf">2.</span>  <span class="p">,</span>   <span class="mf">2.05</span><span class="p">,</span>   <span class="mf">2.1</span> <span class="p">,</span>   <span class="mf">2.15</span><span class="p">,</span>   <span class="mf">2.2</span> <span class="p">,</span>   <span class="mf">2.25</span><span class="p">,</span>   <span class="mf">2.3</span> <span class="p">,</span>   <span class="mf">2.35</span><span class="p">,</span>
         <span class="mf">2.4</span> <span class="p">,</span>   <span class="mf">2.45</span><span class="p">,</span>   <span class="mf">2.5</span> <span class="p">,</span>   <span class="mf">2.55</span><span class="p">,</span>   <span class="mf">2.6</span> <span class="p">,</span>   <span class="mf">2.65</span><span class="p">,</span>   <span class="mf">2.7</span> <span class="p">,</span>   <span class="mf">2.75</span><span class="p">,</span>
         <span class="mf">2.8</span> <span class="p">,</span>   <span class="mf">2.85</span><span class="p">,</span>   <span class="mf">2.9</span> <span class="p">,</span>   <span class="mf">2.95</span><span class="p">,</span>   <span class="mf">3.</span>  <span class="p">,</span>   <span class="mf">3.05</span><span class="p">,</span>   <span class="mf">3.1</span> <span class="p">,</span>   <span class="mf">3.15</span><span class="p">,</span>
         <span class="mf">3.2</span> <span class="p">,</span>   <span class="mf">3.25</span><span class="p">,</span>   <span class="mf">3.3</span> <span class="p">,</span>   <span class="mf">3.35</span><span class="p">,</span>   <span class="mf">3.4</span> <span class="p">,</span>   <span class="mf">3.45</span><span class="p">,</span>   <span class="mf">3.5</span> <span class="p">,</span>   <span class="mf">3.55</span><span class="p">,</span>
         <span class="mf">3.6</span> <span class="p">,</span>   <span class="mf">3.65</span><span class="p">,</span>   <span class="mf">3.7</span> <span class="p">,</span>   <span class="mf">3.75</span><span class="p">,</span>   <span class="mf">3.8</span> <span class="p">,</span>   <span class="mf">3.85</span><span class="p">,</span>   <span class="mf">3.9</span> <span class="p">,</span>   <span class="mf">3.95</span><span class="p">,</span>
         <span class="mf">4.</span>  <span class="p">,</span>   <span class="mf">4.05</span><span class="p">,</span>   <span class="mf">4.1</span> <span class="p">,</span>   <span class="mf">4.15</span><span class="p">,</span>   <span class="mf">4.2</span> <span class="p">,</span>   <span class="mf">4.25</span><span class="p">,</span>   <span class="mf">4.3</span> <span class="p">,</span>   <span class="mf">4.35</span><span class="p">,</span>
         <span class="mf">4.4</span> <span class="p">,</span>   <span class="mf">4.45</span><span class="p">,</span>   <span class="mf">4.5</span> <span class="p">,</span>   <span class="mf">4.55</span><span class="p">,</span>   <span class="mf">4.6</span> <span class="p">,</span>   <span class="mf">4.65</span><span class="p">,</span>   <span class="mf">4.7</span> <span class="p">,</span>   <span class="mf">4.75</span><span class="p">,</span>
         <span class="mf">4.8</span> <span class="p">,</span>   <span class="mf">4.85</span><span class="p">,</span>   <span class="mf">4.9</span> <span class="p">,</span>   <span class="mf">4.95</span><span class="p">,</span>   <span class="mf">5.</span>  <span class="p">,</span>   <span class="mf">5.05</span><span class="p">,</span>   <span class="mf">5.1</span> <span class="p">,</span>   <span class="mf">5.15</span><span class="p">,</span>
         <span class="mf">5.2</span> <span class="p">,</span>   <span class="mf">5.25</span><span class="p">,</span>   <span class="mf">5.3</span> <span class="p">,</span>   <span class="mf">5.35</span><span class="p">,</span>   <span class="mf">5.4</span> <span class="p">,</span>   <span class="mf">5.45</span><span class="p">,</span>   <span class="mf">5.5</span> <span class="p">,</span>   <span class="mf">5.55</span><span class="p">,</span>
         <span class="mf">5.6</span> <span class="p">,</span>   <span class="mf">5.65</span><span class="p">,</span>   <span class="mf">5.7</span> <span class="p">,</span>   <span class="mf">5.75</span><span class="p">,</span>   <span class="mf">5.8</span> <span class="p">,</span>   <span class="mf">5.85</span><span class="p">,</span>   <span class="mf">5.9</span> <span class="p">,</span>   <span class="mf">5.95</span><span class="p">,</span>
         <span class="mf">6.</span>  <span class="p">,</span>   <span class="mf">6.05</span><span class="p">,</span>   <span class="mf">6.1</span> <span class="p">,</span>   <span class="mf">6.15</span><span class="p">,</span>   <span class="mf">6.2</span> <span class="p">,</span>   <span class="mf">6.25</span><span class="p">,</span>   <span class="mf">6.3</span> <span class="p">,</span>   <span class="mf">6.35</span><span class="p">,</span>
         <span class="mf">6.4</span> <span class="p">,</span>   <span class="mf">6.45</span><span class="p">,</span>   <span class="mf">6.5</span> <span class="p">,</span>   <span class="mf">6.55</span><span class="p">,</span>   <span class="mf">6.6</span> <span class="p">,</span>   <span class="mf">6.65</span><span class="p">,</span>   <span class="mf">6.7</span> <span class="p">,</span>   <span class="mf">6.75</span><span class="p">,</span>
         <span class="mf">6.8</span> <span class="p">,</span>   <span class="mf">6.85</span><span class="p">,</span>   <span class="mf">6.9</span> <span class="p">,</span>   <span class="mf">6.95</span><span class="p">,</span>   <span class="mf">7.</span>  <span class="p">,</span>   <span class="mf">7.05</span><span class="p">,</span>   <span class="mf">7.1</span> <span class="p">,</span>   <span class="mf">7.15</span><span class="p">,</span>
         <span class="mf">7.2</span> <span class="p">,</span>   <span class="mf">7.25</span><span class="p">,</span>   <span class="mf">7.3</span> <span class="p">,</span>   <span class="mf">7.35</span><span class="p">,</span>   <span class="mf">7.4</span> <span class="p">,</span>   <span class="mf">7.45</span><span class="p">,</span>   <span class="mf">7.5</span> <span class="p">,</span>   <span class="mf">7.55</span><span class="p">,</span>
         <span class="mf">7.6</span> <span class="p">,</span>   <span class="mf">7.65</span><span class="p">,</span>   <span class="mf">7.7</span> <span class="p">,</span>   <span class="mf">7.75</span><span class="p">,</span>   <span class="mf">7.8</span> <span class="p">,</span>   <span class="mf">7.85</span><span class="p">,</span>   <span class="mf">7.9</span> <span class="p">,</span>   <span class="mf">7.95</span><span class="p">,</span>
         <span class="mf">8.</span>  <span class="p">,</span>   <span class="mf">8.05</span><span class="p">,</span>   <span class="mf">8.1</span> <span class="p">,</span>   <span class="mf">8.15</span><span class="p">,</span>   <span class="mf">8.2</span> <span class="p">,</span>   <span class="mf">8.25</span><span class="p">,</span>   <span class="mf">8.3</span> <span class="p">,</span>   <span class="mf">8.35</span><span class="p">,</span>
         <span class="mf">8.4</span> <span class="p">,</span>   <span class="mf">8.45</span><span class="p">,</span>   <span class="mf">8.5</span> <span class="p">,</span>   <span class="mf">8.55</span><span class="p">,</span>   <span class="mf">8.6</span> <span class="p">,</span>   <span class="mf">8.65</span><span class="p">,</span>   <span class="mf">8.7</span> <span class="p">,</span>   <span class="mf">8.75</span><span class="p">,</span>
         <span class="mf">8.8</span> <span class="p">,</span>   <span class="mf">8.85</span><span class="p">,</span>   <span class="mf">8.9</span> <span class="p">,</span>   <span class="mf">8.95</span><span class="p">,</span>   <span class="mf">9.</span>  <span class="p">,</span>   <span class="mf">9.05</span><span class="p">,</span>   <span class="mf">9.1</span> <span class="p">,</span>   <span class="mf">9.15</span><span class="p">,</span>
         <span class="mf">9.2</span> <span class="p">,</span>   <span class="mf">9.25</span><span class="p">,</span>   <span class="mf">9.3</span> <span class="p">,</span>   <span class="mf">9.35</span><span class="p">,</span>   <span class="mf">9.4</span> <span class="p">,</span>   <span class="mf">9.45</span><span class="p">,</span>   <span class="mf">9.5</span> <span class="p">,</span>   <span class="mf">9.55</span><span class="p">,</span>
         <span class="mf">9.6</span> <span class="p">,</span>   <span class="mf">9.65</span><span class="p">,</span>   <span class="mf">9.7</span> <span class="p">,</span>   <span class="mf">9.75</span><span class="p">,</span>   <span class="mf">9.8</span> <span class="p">,</span>   <span class="mf">9.85</span><span class="p">,</span>   <span class="mf">9.9</span> <span class="p">,</span>   <span class="mf">9.95</span><span class="p">,</span>
        <span class="mf">10.</span>  <span class="p">,</span>  <span class="mf">10.05</span><span class="p">,</span>  <span class="mf">10.1</span> <span class="p">,</span>  <span class="mf">10.15</span><span class="p">,</span>  <span class="mf">10.2</span> <span class="p">,</span>  <span class="mf">10.25</span><span class="p">,</span>  <span class="mf">10.3</span> <span class="p">,</span>  <span class="mf">10.35</span><span class="p">,</span>
        <span class="mf">10.4</span> <span class="p">,</span>  <span class="mf">10.45</span><span class="p">,</span>  <span class="mf">10.5</span> <span class="p">,</span>  <span class="mf">10.55</span><span class="p">,</span>  <span class="mf">10.6</span> <span class="p">,</span>  <span class="mf">10.65</span><span class="p">,</span>  <span class="mf">10.7</span> <span class="p">,</span>  <span class="mf">10.75</span><span class="p">,</span>
        <span class="mf">10.8</span> <span class="p">,</span>  <span class="mf">10.85</span><span class="p">,</span>  <span class="mf">10.9</span> <span class="p">,</span>  <span class="mf">10.95</span><span class="p">,</span>  <span class="mf">11.</span>  <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span> <span class="o">=</span> <span class="n">r3d</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">freq</span><span class="p">())</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">energy</span></tt> method calculates the energy hoeld by each ray</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">energy</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">array</span><span class="p">([</span>  <span class="mf">2.19954455e-07</span><span class="p">,</span>   <span class="mf">1.36579180e-07</span><span class="p">,</span>   <span class="mf">1.17899852e-07</span><span class="p">,</span>
          <span class="mf">8.51486449e-09</span><span class="p">,</span>   <span class="mf">9.61881061e-09</span><span class="p">,</span>   <span class="mf">9.64823678e-09</span><span class="p">,</span>
          <span class="mf">5.43456762e-09</span><span class="p">,</span>   <span class="mf">4.69402578e-09</span><span class="p">,</span>   <span class="mf">1.60256241e-09</span><span class="p">,</span>
          <span class="mf">1.84751543e-09</span><span class="p">,</span>   <span class="mf">2.07034427e-09</span><span class="p">,</span>   <span class="mf">7.88790226e-09</span><span class="p">,</span>
          <span class="mf">9.28452904e-09</span><span class="p">,</span>   <span class="mf">2.01351852e-11</span><span class="p">,</span>   <span class="mf">5.61797262e-11</span><span class="p">,</span>
          <span class="mf">8.14092539e-09</span><span class="p">,</span>   <span class="mf">1.43067548e-10</span><span class="p">,</span>   <span class="mf">7.79904043e-09</span><span class="p">,</span>
          <span class="mf">1.60961650e-10</span><span class="p">,</span>   <span class="mf">1.23770591e-09</span><span class="p">,</span>   <span class="mf">7.69122187e-10</span><span class="p">,</span>
          <span class="mf">1.32195363e-09</span><span class="p">,</span>   <span class="mf">7.19626346e-11</span><span class="p">,</span>   <span class="mf">1.56937090e-10</span><span class="p">,</span>
          <span class="mf">1.76315168e-09</span><span class="p">,</span>   <span class="mf">1.70671456e-09</span><span class="p">,</span>   <span class="mf">1.63390924e-12</span><span class="p">,</span>
          <span class="mf">1.08726484e-11</span><span class="p">,</span>   <span class="mf">1.92742585e-11</span><span class="p">,</span>   <span class="mf">9.92248231e-10</span><span class="p">,</span>
          <span class="mf">2.58605904e-11</span><span class="p">,</span>   <span class="mf">4.00521411e-09</span><span class="p">,</span>   <span class="mf">6.25988801e-12</span><span class="p">,</span>
          <span class="mf">1.40737821e-10</span><span class="p">,</span>   <span class="mf">1.45101925e-10</span><span class="p">,</span>   <span class="mf">9.61318787e-12</span><span class="p">,</span>
          <span class="mf">3.09462403e-13</span><span class="p">,</span>   <span class="mf">1.74402052e-09</span><span class="p">,</span>   <span class="mf">1.96292255e-09</span><span class="p">,</span>
          <span class="mf">2.42817149e-11</span><span class="p">,</span>   <span class="mf">1.03096142e-12</span><span class="p">,</span>   <span class="mf">3.32659357e-11</span><span class="p">,</span>
          <span class="mf">1.51148731e-12</span><span class="p">,</span>   <span class="mf">2.08993268e-11</span><span class="p">,</span>   <span class="mf">2.22840595e-11</span><span class="p">,</span>
          <span class="mf">5.15438190e-11</span><span class="p">,</span>   <span class="mf">3.02707163e-12</span><span class="p">,</span>   <span class="mf">1.31487914e-10</span><span class="p">,</span>
          <span class="mf">3.17622744e-11</span><span class="p">,</span>   <span class="mf">1.82051240e-10</span><span class="p">,</span>   <span class="mf">1.42451677e-10</span><span class="p">,</span>
          <span class="mf">2.89473435e-10</span><span class="p">,</span>   <span class="mf">2.78878940e-10</span><span class="p">,</span>   <span class="mf">1.99779444e-10</span><span class="p">,</span>
          <span class="mf">1.28777166e-11</span><span class="p">,</span>   <span class="mf">1.87460986e-11</span><span class="p">,</span>   <span class="mf">2.06512068e-11</span><span class="p">,</span>
          <span class="mf">4.91234707e-12</span><span class="p">,</span>   <span class="mf">5.48945667e-12</span><span class="p">,</span>   <span class="mf">4.64838070e-11</span><span class="p">,</span>
          <span class="mf">2.33700978e-11</span><span class="p">,</span>   <span class="mf">3.08866534e-12</span><span class="p">,</span>   <span class="mf">3.85157127e-11</span><span class="p">,</span>
          <span class="mf">1.93330939e-11</span><span class="p">,</span>   <span class="mf">3.61888250e-12</span><span class="p">,</span>   <span class="mf">1.81238119e-11</span><span class="p">,</span>
          <span class="mf">9.21826309e-10</span><span class="p">,</span>   <span class="mf">3.12554434e-10</span><span class="p">,</span>   <span class="mf">8.58046727e-12</span><span class="p">,</span>
          <span class="mf">6.47284551e-10</span><span class="p">,</span>   <span class="mf">7.23482333e-12</span><span class="p">,</span>   <span class="mf">1.36413160e-11</span><span class="p">,</span>
          <span class="mf">5.68611445e-12</span><span class="p">,</span>   <span class="mf">1.95064893e-10</span><span class="p">,</span>   <span class="mf">2.76091297e-11</span><span class="p">,</span>
          <span class="mf">7.97359641e-12</span><span class="p">,</span>   <span class="mf">3.26590923e-10</span><span class="p">,</span>   <span class="mf">3.76839430e-10</span><span class="p">,</span>
          <span class="mf">1.67631988e-10</span><span class="p">,</span>   <span class="mf">4.15220913e-11</span><span class="p">,</span>   <span class="mf">3.72736654e-11</span><span class="p">,</span>
          <span class="mf">3.95993445e-11</span><span class="p">,</span>   <span class="mf">7.94286569e-11</span><span class="p">,</span>   <span class="mf">6.20069374e-11</span><span class="p">,</span>
          <span class="mf">3.03537182e-13</span><span class="p">,</span>   <span class="mf">2.63675592e-12</span><span class="p">,</span>   <span class="mf">5.91493799e-12</span><span class="p">,</span>
          <span class="mf">3.30084035e-11</span><span class="p">,</span>   <span class="mf">2.27682935e-11</span><span class="p">,</span>   <span class="mf">8.53134362e-13</span><span class="p">,</span>
          <span class="mf">1.15860491e-12</span><span class="p">,</span>   <span class="mf">2.18836230e-12</span><span class="p">,</span>   <span class="mf">7.42167663e-12</span><span class="p">,</span>
          <span class="mf">1.29254813e-11</span><span class="p">,</span>   <span class="mf">1.29565047e-10</span><span class="p">,</span>   <span class="mf">1.25540575e-10</span><span class="p">,</span>
          <span class="mf">1.31917946e-10</span><span class="p">,</span>   <span class="mf">1.02165639e-10</span><span class="p">,</span>   <span class="mf">2.03400601e-10</span><span class="p">,</span>
          <span class="mf">1.95076759e-10</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">1.88824569e-07</span><span class="p">,</span>   <span class="mf">2.15111951e-08</span><span class="p">,</span>   <span class="mf">2.72204948e-08</span><span class="p">,</span>
          <span class="mf">4.19059189e-08</span><span class="p">,</span>   <span class="mf">1.00593183e-08</span><span class="p">,</span>   <span class="mf">9.77625853e-09</span><span class="p">,</span>
          <span class="mf">3.46446133e-09</span><span class="p">,</span>   <span class="mf">4.27609825e-09</span><span class="p">,</span>   <span class="mf">2.33341044e-09</span><span class="p">,</span>
          <span class="mf">3.12826459e-09</span><span class="p">,</span>   <span class="mf">1.56243992e-09</span><span class="p">,</span>   <span class="mf">7.04193751e-10</span><span class="p">,</span>
          <span class="mf">7.17384005e-10</span><span class="p">,</span>   <span class="mf">4.79905639e-09</span><span class="p">,</span>   <span class="mf">3.99056923e-09</span><span class="p">,</span>
          <span class="mf">8.73343902e-10</span><span class="p">,</span>   <span class="mf">6.43447500e-09</span><span class="p">,</span>   <span class="mf">6.72455259e-10</span><span class="p">,</span>
          <span class="mf">5.25780671e-09</span><span class="p">,</span>   <span class="mf">1.31257514e-09</span><span class="p">,</span>   <span class="mf">7.97156923e-10</span><span class="p">,</span>
          <span class="mf">1.35163948e-09</span><span class="p">,</span>   <span class="mf">7.82131049e-10</span><span class="p">,</span>   <span class="mf">7.36900095e-10</span><span class="p">,</span>
          <span class="mf">8.24541227e-11</span><span class="p">,</span>   <span class="mf">8.02359795e-11</span><span class="p">,</span>   <span class="mf">1.11026827e-10</span><span class="p">,</span>
          <span class="mf">4.89509746e-11</span><span class="p">,</span>   <span class="mf">1.26662242e-10</span><span class="p">,</span>   <span class="mf">8.65701495e-11</span><span class="p">,</span>
          <span class="mf">9.27501366e-11</span><span class="p">,</span>   <span class="mf">2.17330892e-10</span><span class="p">,</span>   <span class="mf">1.76917314e-09</span><span class="p">,</span>
          <span class="mf">5.94927473e-10</span><span class="p">,</span>   <span class="mf">4.53787755e-10</span><span class="p">,</span>   <span class="mf">1.29064043e-10</span><span class="p">,</span>
          <span class="mf">5.26162293e-11</span><span class="p">,</span>   <span class="mf">2.50610752e-11</span><span class="p">,</span>   <span class="mf">3.94990668e-11</span><span class="p">,</span>
          <span class="mf">5.53343046e-10</span><span class="p">,</span>   <span class="mf">1.16311031e-12</span><span class="p">,</span>   <span class="mf">1.21597952e-12</span><span class="p">,</span>
          <span class="mf">9.01210260e-13</span><span class="p">,</span>   <span class="mf">1.59002445e-12</span><span class="p">,</span>   <span class="mf">5.86448259e-10</span><span class="p">,</span>
          <span class="mf">4.36597437e-10</span><span class="p">,</span>   <span class="mf">1.33204577e-12</span><span class="p">,</span>   <span class="mf">1.03157659e-09</span><span class="p">,</span>
          <span class="mf">3.45007431e-12</span><span class="p">,</span>   <span class="mf">1.88710588e-10</span><span class="p">,</span>   <span class="mf">1.46484075e-10</span><span class="p">,</span>
          <span class="mf">2.86933614e-10</span><span class="p">,</span>   <span class="mf">7.89827780e-11</span><span class="p">,</span>   <span class="mf">1.04460963e-10</span><span class="p">,</span>
          <span class="mf">3.12324547e-13</span><span class="p">,</span>   <span class="mf">1.00756538e-10</span><span class="p">,</span>   <span class="mf">2.94764328e-10</span><span class="p">,</span>
          <span class="mf">3.29931234e-10</span><span class="p">,</span>   <span class="mf">4.77796355e-10</span><span class="p">,</span>   <span class="mf">7.78607587e-11</span><span class="p">,</span>
          <span class="mf">1.59764422e-12</span><span class="p">,</span>   <span class="mf">1.15329186e-11</span><span class="p">,</span>   <span class="mf">1.86885940e-12</span><span class="p">,</span>
          <span class="mf">2.92869431e-11</span><span class="p">,</span>   <span class="mf">1.18990854e-11</span><span class="p">,</span>   <span class="mf">2.86813257e-11</span><span class="p">,</span>
          <span class="mf">1.13982295e-11</span><span class="p">,</span>   <span class="mf">5.07632783e-12</span><span class="p">,</span>   <span class="mf">4.06509285e-11</span><span class="p">,</span>
          <span class="mf">4.40674433e-12</span><span class="p">,</span>   <span class="mf">2.46371210e-11</span><span class="p">,</span>   <span class="mf">2.09396398e-11</span><span class="p">,</span>
          <span class="mf">7.22399988e-12</span><span class="p">,</span>   <span class="mf">2.58542333e-12</span><span class="p">,</span>   <span class="mf">3.94710559e-11</span><span class="p">,</span>
          <span class="mf">9.20265151e-12</span><span class="p">,</span>   <span class="mf">2.16571082e-12</span><span class="p">,</span>   <span class="mf">2.93042953e-12</span><span class="p">,</span>
          <span class="mf">4.02050813e-11</span><span class="p">,</span>   <span class="mf">2.04293916e-10</span><span class="p">,</span>   <span class="mf">1.32311037e-10</span><span class="p">,</span>
          <span class="mf">1.62317795e-10</span><span class="p">,</span>   <span class="mf">2.65323503e-10</span><span class="p">,</span>   <span class="mf">2.54076753e-10</span><span class="p">,</span>
          <span class="mf">3.11329246e-11</span><span class="p">,</span>   <span class="mf">3.72034608e-11</span><span class="p">,</span>   <span class="mf">3.69871765e-13</span><span class="p">,</span>
          <span class="mf">1.91760998e-12</span><span class="p">,</span>   <span class="mf">3.16064123e-12</span><span class="p">,</span>   <span class="mf">3.64866766e-14</span><span class="p">,</span>
          <span class="mf">2.64607864e-13</span><span class="p">,</span>   <span class="mf">5.97790217e-14</span><span class="p">,</span>   <span class="mf">2.30858796e-13</span><span class="p">,</span>
          <span class="mf">4.69874532e-13</span><span class="p">,</span>   <span class="mf">8.81461085e-13</span><span class="p">,</span>   <span class="mf">8.40439380e-13</span><span class="p">,</span>
          <span class="mf">1.05220969e-12</span><span class="p">,</span>   <span class="mf">7.06154253e-13</span><span class="p">,</span>   <span class="mf">2.15410100e-12</span><span class="p">,</span>
          <span class="mf">1.71521146e-12</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">7.81598282e-09</span><span class="p">,</span>   <span class="mf">7.06989008e-10</span><span class="p">,</span>   <span class="mf">9.31319595e-10</span><span class="p">,</span>
          <span class="mf">2.14972225e-11</span><span class="p">,</span>   <span class="mf">6.52449967e-14</span><span class="p">,</span>   <span class="mf">2.10233677e-14</span><span class="p">,</span>
          <span class="mf">6.70925856e-11</span><span class="p">,</span>   <span class="mf">1.03352488e-10</span><span class="p">,</span>   <span class="mf">1.80795037e-08</span><span class="p">,</span>
          <span class="mf">1.63654279e-08</span><span class="p">,</span>   <span class="mf">2.39969577e-12</span><span class="p">,</span>   <span class="mf">1.14472498e-11</span><span class="p">,</span>
          <span class="mf">3.11389338e-11</span><span class="p">,</span>   <span class="mf">1.38256462e-12</span><span class="p">,</span>   <span class="mf">4.42905241e-11</span><span class="p">,</span>
          <span class="mf">1.75693702e-12</span><span class="p">,</span>   <span class="mf">1.90314844e-14</span><span class="p">,</span>   <span class="mf">3.12354914e-12</span><span class="p">,</span>
          <span class="mf">4.19906029e-12</span><span class="p">,</span>   <span class="mf">5.78286436e-11</span><span class="p">,</span>   <span class="mf">3.59728626e-11</span><span class="p">,</span>
          <span class="mf">6.14481358e-11</span><span class="p">,</span>   <span class="mf">6.79480631e-10</span><span class="p">,</span>   <span class="mf">6.05514071e-10</span><span class="p">,</span>
          <span class="mf">1.96838421e-10</span><span class="p">,</span>   <span class="mf">2.77321466e-10</span><span class="p">,</span>   <span class="mf">4.11463913e-12</span><span class="p">,</span>
          <span class="mf">4.12063308e-12</span><span class="p">,</span>   <span class="mf">2.00593732e-09</span><span class="p">,</span>   <span class="mf">4.51691352e-10</span><span class="p">,</span>
          <span class="mf">2.85583625e-09</span><span class="p">,</span>   <span class="mf">2.87115862e-12</span><span class="p">,</span>   <span class="mf">1.82577916e-13</span><span class="p">,</span>
          <span class="mf">7.75856359e-12</span><span class="p">,</span>   <span class="mf">1.29945927e-11</span><span class="p">,</span>   <span class="mf">1.76772730e-11</span><span class="p">,</span>
          <span class="mf">1.53990133e-11</span><span class="p">,</span>   <span class="mf">5.35381643e-10</span><span class="p">,</span>   <span class="mf">5.52812141e-10</span><span class="p">,</span>
          <span class="mf">1.08943753e-12</span><span class="p">,</span>   <span class="mf">1.13543553e-09</span><span class="p">,</span>   <span class="mf">1.07206137e-09</span><span class="p">,</span>
          <span class="mf">7.23835242e-10</span><span class="p">,</span>   <span class="mf">8.82558451e-10</span><span class="p">,</span>   <span class="mf">6.71910336e-12</span><span class="p">,</span>
          <span class="mf">8.19447564e-13</span><span class="p">,</span>   <span class="mf">1.24537835e-09</span><span class="p">,</span>   <span class="mf">2.01990895e-11</span><span class="p">,</span>
          <span class="mf">1.75357148e-10</span><span class="p">,</span>   <span class="mf">1.10982855e-15</span><span class="p">,</span>   <span class="mf">3.11072660e-16</span><span class="p">,</span>
          <span class="mf">1.88416979e-16</span><span class="p">,</span>   <span class="mf">1.27250195e-12</span><span class="p">,</span>   <span class="mf">4.66771793e-12</span><span class="p">,</span>
          <span class="mf">6.02809770e-12</span><span class="p">,</span>   <span class="mf">2.77103047e-12</span><span class="p">,</span>   <span class="mf">8.48120362e-11</span><span class="p">,</span>
          <span class="mf">2.24993894e-11</span><span class="p">,</span>   <span class="mf">3.91266033e-11</span><span class="p">,</span>   <span class="mf">2.59325952e-12</span><span class="p">,</span>
          <span class="mf">4.78224409e-10</span><span class="p">,</span>   <span class="mf">1.43820286e-11</span><span class="p">,</span>   <span class="mf">5.36457274e-10</span><span class="p">,</span>
          <span class="mf">3.00141869e-11</span><span class="p">,</span>   <span class="mf">1.73185122e-11</span><span class="p">,</span>   <span class="mf">3.54348024e-11</span><span class="p">,</span>
          <span class="mf">1.20911441e-12</span><span class="p">,</span>   <span class="mf">4.42120111e-11</span><span class="p">,</span>   <span class="mf">3.08636654e-10</span><span class="p">,</span>
          <span class="mf">6.61285902e-13</span><span class="p">,</span>   <span class="mf">4.81616980e-10</span><span class="p">,</span>   <span class="mf">3.48654120e-11</span><span class="p">,</span>
          <span class="mf">5.86080674e-12</span><span class="p">,</span>   <span class="mf">2.56490116e-11</span><span class="p">,</span>   <span class="mf">7.44256842e-10</span><span class="p">,</span>
          <span class="mf">1.26641671e-10</span><span class="p">,</span>   <span class="mf">5.16460485e-11</span><span class="p">,</span>   <span class="mf">4.81089342e-11</span><span class="p">,</span>
          <span class="mf">4.43470902e-14</span><span class="p">,</span>   <span class="mf">2.45398330e-12</span><span class="p">,</span>   <span class="mf">4.33904577e-14</span><span class="p">,</span>
          <span class="mf">1.89647368e-12</span><span class="p">,</span>   <span class="mf">1.95176206e-13</span><span class="p">,</span>   <span class="mf">2.35981418e-12</span><span class="p">,</span>
          <span class="mf">4.16792885e-12</span><span class="p">,</span>   <span class="mf">3.45161556e-12</span><span class="p">,</span>   <span class="mf">1.68630518e-11</span><span class="p">,</span>
          <span class="mf">6.17464219e-12</span><span class="p">,</span>   <span class="mf">7.10786981e-13</span><span class="p">,</span>   <span class="mf">3.43855229e-12</span><span class="p">,</span>
          <span class="mf">3.09336180e-11</span><span class="p">,</span>   <span class="mf">3.63273397e-12</span><span class="p">,</span>   <span class="mf">5.33634536e-11</span><span class="p">,</span>
          <span class="mf">5.27619450e-11</span><span class="p">,</span>   <span class="mf">2.70474032e-14</span><span class="p">,</span>   <span class="mf">2.90196176e-14</span><span class="p">,</span>
          <span class="mf">3.93485084e-14</span><span class="p">,</span>   <span class="mf">2.62316157e-14</span><span class="p">,</span>   <span class="mf">1.17122788e-14</span><span class="p">,</span>
          <span class="mf">1.35967850e-14</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([</span>  <span class="mf">7.81598282e-09</span><span class="p">,</span>   <span class="mf">1.15824587e-10</span><span class="p">,</span>   <span class="mf">2.15549811e-10</span><span class="p">,</span>
          <span class="mf">4.67517373e-11</span><span class="p">,</span>   <span class="mf">6.52481000e-14</span><span class="p">,</span>   <span class="mf">2.10232692e-14</span><span class="p">,</span>
          <span class="mf">9.51589544e-10</span><span class="p">,</span>   <span class="mf">1.12075448e-09</span><span class="p">,</span>   <span class="mf">1.80795037e-08</span><span class="p">,</span>
          <span class="mf">1.63654279e-08</span><span class="p">,</span>   <span class="mf">1.30983082e-12</span><span class="p">,</span>   <span class="mf">3.66488513e-12</span><span class="p">,</span>
          <span class="mf">7.31784820e-12</span><span class="p">,</span>   <span class="mf">7.27180289e-11</span><span class="p">,</span>   <span class="mf">1.43371855e-12</span><span class="p">,</span>
          <span class="mf">3.26622292e-12</span><span class="p">,</span>   <span class="mf">2.81865630e-13</span><span class="p">,</span>   <span class="mf">5.27410962e-12</span><span class="p">,</span>
          <span class="mf">8.38974101e-11</span><span class="p">,</span>   <span class="mf">5.78277573e-11</span><span class="p">,</span>   <span class="mf">3.59713712e-11</span><span class="p">,</span>
          <span class="mf">6.14482199e-11</span><span class="p">,</span>   <span class="mf">2.42780789e-09</span><span class="p">,</span>   <span class="mf">2.46455218e-09</span><span class="p">,</span>
          <span class="mf">1.66993987e-11</span><span class="p">,</span>   <span class="mf">1.78630109e-11</span><span class="p">,</span>   <span class="mf">2.58456199e-09</span><span class="p">,</span>
          <span class="mf">3.66001841e-09</span><span class="p">,</span>   <span class="mf">6.07245662e-12</span><span class="p">,</span>   <span class="mf">6.98043930e-10</span><span class="p">,</span>
          <span class="mf">7.50441222e-12</span><span class="p">,</span>   <span class="mf">2.71325903e-12</span><span class="p">,</span>   <span class="mf">1.56773182e-13</span><span class="p">,</span>
          <span class="mf">1.77657884e-12</span><span class="p">,</span>   <span class="mf">2.25153672e-12</span><span class="p">,</span>   <span class="mf">3.38175627e-09</span><span class="p">,</span>
          <span class="mf">3.83736986e-09</span><span class="p">,</span>   <span class="mf">4.49014806e-10</span><span class="p">,</span>   <span class="mf">4.39750694e-10</span><span class="p">,</span>
          <span class="mf">1.83501178e-13</span><span class="p">,</span>   <span class="mf">1.41113208e-10</span><span class="p">,</span>   <span class="mf">1.01402766e-10</span><span class="p">,</span>
          <span class="mf">1.32421425e-10</span><span class="p">,</span>   <span class="mf">1.22234658e-10</span><span class="p">,</span>   <span class="mf">2.57800281e-13</span><span class="p">,</span>
          <span class="mf">6.65719632e-12</span><span class="p">,</span>   <span class="mf">2.51611805e-10</span><span class="p">,</span>   <span class="mf">2.47641029e-12</span><span class="p">,</span>
          <span class="mf">1.18833535e-09</span><span class="p">,</span>   <span class="mf">4.76083758e-16</span><span class="p">,</span>   <span class="mf">4.05162814e-16</span><span class="p">,</span>
          <span class="mf">2.01791912e-16</span><span class="p">,</span>   <span class="mf">2.26866874e-12</span><span class="p">,</span>   <span class="mf">1.58752239e-11</span><span class="p">,</span>
          <span class="mf">3.58206175e-10</span><span class="p">,</span>   <span class="mf">8.58606175e-11</span><span class="p">,</span>   <span class="mf">9.70940751e-12</span><span class="p">,</span>
          <span class="mf">3.26028634e-11</span><span class="p">,</span>   <span class="mf">5.06316202e-11</span><span class="p">,</span>   <span class="mf">8.53567507e-12</span><span class="p">,</span>
          <span class="mf">1.69890259e-11</span><span class="p">,</span>   <span class="mf">3.84880232e-10</span><span class="p">,</span>   <span class="mf">1.89905106e-11</span><span class="p">,</span>
          <span class="mf">7.74629538e-12</span><span class="p">,</span>   <span class="mf">4.37341162e-10</span><span class="p">,</span>   <span class="mf">9.92337567e-12</span><span class="p">,</span>
          <span class="mf">5.57475724e-14</span><span class="p">,</span>   <span class="mf">7.04692578e-11</span><span class="p">,</span>   <span class="mf">2.39802425e-12</span><span class="p">,</span>
          <span class="mf">1.59111295e-14</span><span class="p">,</span>   <span class="mf">2.97468083e-12</span><span class="p">,</span>   <span class="mf">5.28680146e-11</span><span class="p">,</span>
          <span class="mf">3.24890054e-10</span><span class="p">,</span>   <span class="mf">2.65661336e-11</span><span class="p">,</span>   <span class="mf">1.96985129e-11</span><span class="p">,</span>
          <span class="mf">1.14447142e-10</span><span class="p">,</span>   <span class="mf">4.61435065e-11</span><span class="p">,</span>   <span class="mf">3.98223586e-11</span><span class="p">,</span>
          <span class="mf">2.05730511e-14</span><span class="p">,</span>   <span class="mf">2.93299384e-12</span><span class="p">,</span>   <span class="mf">6.21973278e-14</span><span class="p">,</span>
          <span class="mf">1.71905475e-12</span><span class="p">,</span>   <span class="mf">2.71642001e-13</span><span class="p">,</span>   <span class="mf">2.03035901e-12</span><span class="p">,</span>
          <span class="mf">5.26440799e-12</span><span class="p">,</span>   <span class="mf">6.32352145e-12</span><span class="p">,</span>   <span class="mf">2.59907385e-12</span><span class="p">,</span>
          <span class="mf">2.18857339e-13</span><span class="p">,</span>   <span class="mf">3.86508775e-15</span><span class="p">,</span>   <span class="mf">2.32554095e-11</span><span class="p">,</span>
          <span class="mf">1.91459286e-12</span><span class="p">,</span>   <span class="mf">2.31650439e-11</span><span class="p">,</span>   <span class="mf">7.44577473e-12</span><span class="p">,</span>
          <span class="mf">7.00958397e-12</span><span class="p">,</span>   <span class="mf">2.56722372e-14</span><span class="p">,</span>   <span class="mf">2.83859910e-14</span><span class="p">,</span>
          <span class="mf">1.87600534e-14</span><span class="p">,</span>   <span class="mf">1.45466058e-14</span><span class="p">,</span>   <span class="mf">1.17569688e-14</span><span class="p">,</span>
          <span class="mf">1.36132272e-14</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="section" id="apply-waveform">
<h2>Apply waveform<a class="headerlink" href="#apply-waveform" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">freq</span>
<span class="n">sco</span><span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">sca</span><span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;W1offset&#39;</span><span class="p">)</span>
<span class="c">#wav = wvf.Waveform({&#39;type&#39; : &#39;generic&#39;,&#39;band&#39;: 0.499,&#39;fc&#39;: 4.493, &#39;fe&#39;: 100, &#39;thresh&#39;: 3, &#39;tw&#39;: 30})</span>
<span class="n">wav</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="./SIM-where1_files/SIM-where1_40_0.png" src="./SIM-where1_files/SIM-where1_40_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">ciro</span> <span class="o">=</span> <span class="n">sco</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
<span class="n">cira</span> <span class="o">=</span> <span class="n">sca</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ciro</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">u&#39;received waveform without antenna $</span><span class="se">\\</span><span class="s">theta</span><span class="se">\\</span><span class="s">theta$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/usr/local/lib/python2.7/dist-packages/matplotlib/axes.py:4747: UserWarning: No labeled objects found. Use label='...' kwarg on individual plots.
  warnings.warn("No labeled objects found. "</pre>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.text.Text at 0xcba5990&gt;</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_42_2.png" src="./SIM-where1_files/SIM-where1_42_2.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">cira</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;received waveform with antenna&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.text.Text at 0xcf70090&gt;</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_43_1.png" src="./SIM-where1_files/SIM-where1_43_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="c">#dchan={i:&#39;ch&#39;+str(i) for i in range(1,5)}</span>
<span class="n">dchan</span><span class="o">=</span><span class="p">{}</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch3&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch4&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch1&#39;</span>
<span class="n">dchan</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;ch2&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Measurements&quot;</span><span class="p">)</span>
<span class="n">cmd</span><span class="o">=</span><span class="s">&#39;M.tdd.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dchan</span><span class="p">[</span><span class="n">irx</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;.plot(ax=ax1)&#39;</span>
<span class="nb">eval</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;WHERE1 measurement&#39;</span><span class="p">)</span>
<span class="c">#M.tdd.ch2.plot()</span>
<span class="c"># align for plotting</span>
<span class="c">#ciro.x=ciro.x-ciro.x[0]</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Simulation-with antenna&quot;</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Simulation-with antenna - without noise&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c">#ax3 = fig.add_subplot(313,title=&quot;Simulation-without antenna&quot;,sharex=ax1, sharey=ax1)</span>
<span class="c">#ciro.plot()</span>
</pre></div>
</div>
<img alt="./SIM-where1_files/SIM-where1_45_0.png" src="./SIM-where1_files/SIM-where1_45_0.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">v</span> <span class="o">=</span> <span class="n">tx</span><span class="o">-</span><span class="n">rx</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>

<span class="k">print</span> <span class="s">&#39;real delay between tx and rx&#39;</span><span class="p">,</span><span class="n">d</span><span class="o">/</span><span class="mf">0.3</span>
<span class="k">print</span> <span class="s">&#39;simulated first path delay&#39;</span><span class="p">,</span><span class="n">r3d</span><span class="o">.</span><span class="n">delays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><pre>real delay between tx and rx 22.4680672606
simulated first path delay 22.4680672606</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">delays</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span>  <span class="mf">22.46806726</span><span class="p">,</span>   <span class="mf">24.18292882</span><span class="p">,</span>   <span class="mf">24.99628065</span><span class="p">,</span>   <span class="mf">25.87437157</span><span class="p">,</span>
         <span class="mf">42.95559158</span><span class="p">,</span>   <span class="mf">51.79056452</span><span class="p">,</span>   <span class="mf">27.37668906</span><span class="p">,</span>   <span class="mf">28.09774198</span><span class="p">,</span>
         <span class="mf">29.40772086</span><span class="p">,</span>   <span class="mf">30.73782761</span><span class="p">,</span>   <span class="mf">41.71071752</span><span class="p">,</span>   <span class="mf">43.87690563</span><span class="p">,</span>
         <span class="mf">44.3303829</span> <span class="p">,</span>   <span class="mf">44.83132695</span><span class="p">,</span>   <span class="mf">45.78534275</span><span class="p">,</span>   <span class="mf">52.55723141</span><span class="p">,</span>
         <span class="mf">52.83546805</span><span class="p">,</span>   <span class="mf">52.93640121</span><span class="p">,</span>   <span class="mf">53.35513533</span><span class="p">,</span>   <span class="mf">57.24533827</span><span class="p">,</span>
         <span class="mf">73.04881379</span><span class="p">,</span>   <span class="mf">77.74128409</span><span class="p">,</span>   <span class="mf">32.08555912</span><span class="p">,</span>   <span class="mf">33.30890428</span><span class="p">,</span>
         <span class="mf">42.65892586</span><span class="p">,</span>   <span class="mf">43.12521253</span><span class="p">,</span>   <span class="mf">45.714854</span>  <span class="p">,</span>   <span class="mf">46.15027493</span><span class="p">,</span>
         <span class="mf">46.65080504</span><span class="p">,</span>   <span class="mf">46.95937444</span><span class="p">,</span>   <span class="mf">47.07757014</span><span class="p">,</span>   <span class="mf">47.80358614</span><span class="p">,</span>
         <span class="mf">48.77327119</span><span class="p">,</span>   <span class="mf">53.58718769</span><span class="p">,</span>   <span class="mf">53.95912049</span><span class="p">,</span>   <span class="mf">54.09963462</span><span class="p">,</span>
         <span class="mf">54.46806832</span><span class="p">,</span>   <span class="mf">55.15670923</span><span class="p">,</span>   <span class="mf">55.87720978</span><span class="p">,</span>   <span class="mf">56.27546336</span><span class="p">,</span>
         <span class="mf">57.93987188</span><span class="p">,</span>   <span class="mf">58.28403515</span><span class="p">,</span>   <span class="mf">73.59435574</span><span class="p">,</span>   <span class="mf">73.8656158</span> <span class="p">,</span>
         <span class="mf">74.74796992</span><span class="p">,</span>   <span class="mf">75.18892262</span><span class="p">,</span>   <span class="mf">78.25411972</span><span class="p">,</span>   <span class="mf">78.44138572</span><span class="p">,</span>
         <span class="mf">78.50928131</span><span class="p">,</span>   <span class="mf">87.50257849</span><span class="p">,</span>   <span class="mf">99.12940895</span><span class="p">,</span>  <span class="mf">104.69401317</span><span class="p">,</span>
         <span class="mf">45.82339965</span><span class="p">,</span>   <span class="mf">46.68815648</span><span class="p">,</span>   <span class="mf">48.68108335</span><span class="p">,</span>   <span class="mf">49.49593798</span><span class="p">,</span>
         <span class="mf">49.56104933</span><span class="p">,</span>   <span class="mf">49.58661092</span><span class="p">,</span>   <span class="mf">49.98831846</span><span class="p">,</span>   <span class="mf">50.36166807</span><span class="p">,</span>
         <span class="mf">56.13899433</span><span class="p">,</span>   <span class="mf">56.62835391</span><span class="p">,</span>   <span class="mf">56.8470464</span> <span class="p">,</span>   <span class="mf">56.9818197</span> <span class="p">,</span>
         <span class="mf">57.33036252</span><span class="p">,</span>   <span class="mf">57.33173446</span><span class="p">,</span>   <span class="mf">60.30778352</span><span class="p">,</span>   <span class="mf">60.96744011</span><span class="p">,</span>
         <span class="mf">75.28119956</span><span class="p">,</span>   <span class="mf">75.47270498</span><span class="p">,</span>   <span class="mf">75.54640301</span><span class="p">,</span>   <span class="mf">75.71904704</span><span class="p">,</span>
         <span class="mf">75.98272228</span><span class="p">,</span>   <span class="mf">76.00084997</span><span class="p">,</span>   <span class="mf">78.9496738</span> <span class="p">,</span>   <span class="mf">79.20259461</span><span class="p">,</span>
         <span class="mf">80.02316697</span><span class="p">,</span>   <span class="mf">80.52147075</span><span class="p">,</span>   <span class="mf">87.95852001</span><span class="p">,</span>   <span class="mf">88.18560678</span><span class="p">,</span>
         <span class="mf">99.53210396</span><span class="p">,</span>   <span class="mf">99.73284172</span><span class="p">,</span>  <span class="mf">105.07538433</span><span class="p">,</span>  <span class="mf">105.26555179</span><span class="p">,</span>
         <span class="mf">52.33385121</span><span class="p">,</span>   <span class="mf">53.09267353</span><span class="p">,</span>   <span class="mf">59.38794302</span><span class="p">,</span>   <span class="mf">60.05770372</span><span class="p">,</span>
         <span class="mf">77.11847384</span><span class="p">,</span>   <span class="mf">77.54594822</span><span class="p">,</span>   <span class="mf">77.63542367</span><span class="p">,</span>   <span class="mf">78.06006716</span><span class="p">,</span>
         <span class="mf">80.70347572</span><span class="p">,</span>   <span class="mf">81.19760461</span><span class="p">,</span>   <span class="mf">89.53603321</span><span class="p">,</span>   <span class="mf">89.98167171</span><span class="p">,</span>
        <span class="mf">100.92888446</span><span class="p">,</span>  <span class="mf">101.32442804</span><span class="p">,</span>  <span class="mf">106.39941914</span><span class="p">,</span>  <span class="mf">106.77469922</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r3d</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>-------------------------
Informations of ray # 0
-------------------------

Index , type, slab      , th(rad), alpha     , gamma2
    0 , B0  , -         , -      , -         , -
    0 , T   , PARTITION ,    0.43,  (0.35+0j),  (0.88+0j)
    0 , B   , -         , -      , -         , -

----------------------------------------
 Matrix of ray # 0 at f= 2.0
----------------------------------------
rotation matrix# type: B0
[[-0.99533359 -0.09649373]
 [ 0.09649373 -0.99533359]]
interaction # 0 type: T
[[ 0.29697185+0.47269683j  0.00000000+0.j        ]
 [ 0.00000000+0.j          0.34443500+0.50490218j]]
rotation matrix# [0] type: B
[[ 0.99533359  0.09649373]
 [-0.09649373  0.99533359]]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ct</span><span class="o">.</span><span class="n">doadod</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(&lt;matplotlib.figure.Figure at 0xcf848d0&gt;,
 &lt;matplotlib.axes.AxesSubplot at 0xcdc3a90&gt;)</pre>
</div>
<img alt="./SIM-where1_files/SIM-where1_49_1.png" src="./SIM-where1_files/SIM-where1_49_1.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, PyLayers developer team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_setDomainName', 'pylayers.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })(); 
</script> 
 
  </body>
</html>