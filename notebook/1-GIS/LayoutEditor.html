

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Layout class &mdash; PyLayers</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Python
          

          
            
            <img src="../../_static/pylayers.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLayout1.html">Loading an outdoor layout from its address</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_antenna.html">Antenna Pattern for an H plane sectoral antenna &#64; 32GHz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLayout2.html">Building graphs of a Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_coverage.html">Indoor Radio Coverage with Motley Keenan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_layout.html">8 Random Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exAbsGas.html">Attenuation due to atmospheric gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exDLink.html">Evaluation of a radio link DLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_w1.html">Indoor Radio Coverage FP7 WHERE1 M1 setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLuebbers.html">UWB Ray tracing simulation  in outdoor scenario</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_diffraction_polar.html">Diffraction coefficient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_diffraction.html">Diffraction coefficient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html">1&nbsp;&nbsp;&nbsp;pylayers.util.project Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.gis.layout">2&nbsp;&nbsp;&nbsp;pylayers.gis.layout Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.gis.selectl">3&nbsp;&nbsp;&nbsp;pylayers.gis.selectl Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.gis.srtm">4&nbsp;&nbsp;&nbsp;pylayers.gis.srtm Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.gis.osmparser">5&nbsp;&nbsp;&nbsp;pylayers.gis.osmparser Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.gis.ezone">6&nbsp;&nbsp;&nbsp;pylayers.gis.ezone Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.antenna">7&nbsp;&nbsp;&nbsp;pylayers.antprop.antenna Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.aarray">8&nbsp;&nbsp;&nbsp;pylayers.antprop.aarray Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.spharm">9&nbsp;&nbsp;&nbsp;pylayers.antprop.spharm Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.antssh">10&nbsp;&nbsp;&nbsp;pylayers.antprop.antssh Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.antvsh">11&nbsp;&nbsp;&nbsp;pylayers.antprop.antvsh Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.slab">12&nbsp;&nbsp;&nbsp;pylayers.antprop.slab Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.signature">13&nbsp;&nbsp;&nbsp;pylayers.antprop.signature Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.interactions">14&nbsp;&nbsp;&nbsp;pylayers.antprop.interactions Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.diffraction">15&nbsp;&nbsp;&nbsp;pylayers.antprop.diffraction Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.diffRT">16&nbsp;&nbsp;&nbsp;pylayers.antprop.diffRT Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.rays">17&nbsp;&nbsp;&nbsp;pylayers.antprop.rays Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.loss">18&nbsp;&nbsp;&nbsp;pylayers.antprop.loss Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.channel">19&nbsp;&nbsp;&nbsp;pylayers.antprop.channel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#id39">20&nbsp;&nbsp;&nbsp;pylayers.antprop.loss Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.coverage">21&nbsp;&nbsp;&nbsp;pylayers.antprop.coverage Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.antprop.coeffModel">22&nbsp;&nbsp;&nbsp;pylayers.antprop.coeffModel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.simul.link">23&nbsp;&nbsp;&nbsp;pylayers.simul.link Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.simul.exploit">24&nbsp;&nbsp;&nbsp;pylayers.simul.exploit Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.simul.exploit_simulnet">25&nbsp;&nbsp;&nbsp;pylayers.simul.exploit_simulnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.simul.simulnet">26&nbsp;&nbsp;&nbsp;pylayers.simul.simulnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.simul.simultraj">27&nbsp;&nbsp;&nbsp;pylayers.simul.simultraj Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.exploit.simnet">28&nbsp;&nbsp;&nbsp;pylayers.exploit.simnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.measures.mesuwb">29&nbsp;&nbsp;&nbsp;pylayers.measures.mesuwb Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.measures.mesmimo">30&nbsp;&nbsp;&nbsp;pylayers.measures.mesmimo Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.measures.cormoran">31&nbsp;&nbsp;&nbsp;pylayers.measures.cormoran Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.measures.vna.E5072A">32&nbsp;&nbsp;&nbsp;pylayers.measures.vna.E5072A Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.measures.parker.smparker">33&nbsp;&nbsp;&nbsp;pylayers.measures.parker.smparker Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.signal.bsignal">34&nbsp;&nbsp;&nbsp;pylayers.signal.bsignal Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.signal.standard">35&nbsp;&nbsp;&nbsp;pylayers.signal.standard Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.signal.device">36&nbsp;&nbsp;&nbsp;pylayers.signal.device Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.signal.DF">37&nbsp;&nbsp;&nbsp;pylayers.signal.DF Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.signal.waveform">38&nbsp;&nbsp;&nbsp;pylayers.signal.waveform Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.mobility.agent">39&nbsp;&nbsp;&nbsp;pylayers.mobility.agent Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#module-pylayers.mobility.ban.body">40&nbsp;&nbsp;&nbsp;pylayers.mobility.ban.body Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/references.html#id138">41&nbsp;&nbsp;&nbsp;pylayers.measures.cormoran Module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>The Layout class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebook/1-GIS/LayoutEditor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-layout-class">
<h1>The Layout class<a class="headerlink" href="#the-layout-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This section explains the main features of the <strong>Layout</strong> class.</p>
<p>A Layout is a representation of a floorplan, it is handled by the module
<strong>pylayers.gis.layout</strong>.</p>
<p>This module recognizes different file formats including geo-referenced
files in open street map format <code class="docutils literal notranslate"><span class="pre">.osm</span></code>.</p>
<p>Using osm allows to take advantage of a mature floor plan editor <em>JOSM</em>
with the plugin <em>PicLayer</em>. This is well described in
<a class="reference external" href="http://wiki.openstreetmap.org/wiki/IndoorOSM">http://wiki.openstreetmap.org/wiki/IndoorOSM</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">pylayers.gis.osmparser</span></code> module parses <code class="docutils literal notranslate"><span class="pre">osm</span></code> files.</p>
<p>See the following methods of the layout object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">importosm()</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">exportosm()</span></code></li>
</ul>
</div>
<div class="section" id="structure-of-a-layout">
<h2>Structure of a Layout<a class="headerlink" href="#structure-of-a-layout" title="Permalink to this headline">¶</a></h2>
<p>At first a Layout is described by a set of points (negative index) and a
set of segments (positive index).</p>
<p>Points and segments are nodes of the <span class="math notranslate nohighlight">\(\mathcal{G}_s\)</span> graph.</p>
<p>It is required to respect a strict non overlapping rule. <strong>No segments
can recover partially or totally an other segment</strong>.</p>
<p>This rule allows to capture topological relations of the network which
are exploited for further analysis.</p>
</div>
<div class="section" id="subsegments">
<h2>Subsegments<a class="headerlink" href="#subsegments" title="Permalink to this headline">¶</a></h2>
<p>To describe doors and windows, the concept of <code class="docutils literal notranslate"><span class="pre">subsegment</span></code> is
introduced.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">segment</span></code> has attributes :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> : slab name</li>
<li><code class="docutils literal notranslate"><span class="pre">z</span></code> : tuple of minimum and maximum heights with respect to ground
(meters)</li>
<li><code class="docutils literal notranslate"><span class="pre">transition</span></code> : a boolean indicating if a human can cross this
segment. For example, segments associated with a door are transition
segments but we will see later that it may be judicious to split
space with transparent segments which have the name ‘AIR’. Those
segments are also <code class="docutils literal notranslate"><span class="pre">transition=True</span></code></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">subsegment</span></code> belongs to a <code class="docutils literal notranslate"><span class="pre">segment</span></code>, it has mainly 2 attached
parameters :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ss_name</span></code> : subsegment slab name</li>
<li><code class="docutils literal notranslate"><span class="pre">ss_z</span></code> : [(zmin1,zmax1),(zmin2,zmax2),…,(zminK,zmaxK))] list of
minimum and maximum height of associated subsegments (meters)</li>
</ul>
<p>When appearing in a 3D ray a subsegment should have a unique index
different from the segment index.</p>
</div>
<div class="section" id="the-different-layout-format">
<h2>The different layout format<a class="headerlink" href="#the-different-layout-format" title="Permalink to this headline">¶</a></h2>
<p>The layout format has regularly evolved over time and is going to evolve
again. Currently, the different recognized file extensions are the
following :</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">.ini</span></code> : an ini file which gather node list and edge list as well
as the involved slabs and materials of the current <code class="docutils literal notranslate"><span class="pre">display</span></code>
dictionnary</li>
<li><code class="docutils literal notranslate"><span class="pre">.osm</span></code> : an xml file which can be edited with
<a class="reference external" href="http://josm.openstreetmap.de/">JOSM</a></li>
</ul>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>from pylayers.gis.layout import *
from pylayers.util.project import *
%matplotlib inline
</pre></div>
</div>
</div>
<div class="section" id="reading-a-layout">
<h2>Reading a Layout<a class="headerlink" href="#reading-a-layout" title="Permalink to this headline">¶</a></h2>
<p>To read an existing layout, it is sufficient to create a Layout object
with, as an argument, a file name with one of the recognized extension.
All files are stored in the <code class="docutils literal notranslate"><span class="pre">pstruc['DIRINI']</span></code> directory of the
project. The project root directory is defined in the <code class="docutils literal notranslate"><span class="pre">$BASENAME</span></code>
environment variable.</p>
<p><code class="docutils literal notranslate"><span class="pre">pstruc</span></code> is a dictionnary which gathers all directories which are used
in <code class="docutils literal notranslate"><span class="pre">PyLayers</span></code></p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>pstruc
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;DIRANT&#39;: &#39;ant&#39;,
 &#39;DIRBODY&#39;: &#39;body&#39;,
 &#39;DIRC3D&#39;: &#39;body/c3d&#39;,
 &#39;DIRCIR&#39;: &#39;output&#39;,
 &#39;DIRCT&#39;: &#39;output/Ct&#39;,
 &#39;DIRFUR&#39;: &#39;struc/furnitures&#39;,
 &#39;DIRGEOM&#39;: &#39;geom&#39;,
 &#39;DIRGIS&#39;: &#39;gis&#39;,
 &#39;DIRH&#39;: &#39;output/H&#39;,
 &#39;DIRIMAGE&#39;: &#39;struc/images&#39;,
 &#39;DIRINI&#39;: &#39;struc/ini&#39;,
 &#39;DIRLCH&#39;: &#39;output&#39;,
 &#39;DIRLNK&#39;: &#39;output&#39;,
 &#39;DIRMAT&#39;: &#39;ini&#39;,
 &#39;DIRMAT2&#39;: &#39;ini&#39;,
 &#39;DIRMES&#39;: &#39;meas&#39;,
 &#39;DIRNETSAVE&#39;: &#39;netsave&#39;,
 &#39;DIROOSM&#39;: &#39;gis/osm&#39;,
 &#39;DIROSM&#39;: &#39;struc/osm&#39;,
 &#39;DIRPICKLE&#39;: &#39;struc/gpickle&#39;,
 &#39;DIRR2D&#39;: &#39;output/r2d&#39;,
 &#39;DIRR3D&#39;: &#39;output/r3d&#39;,
 &#39;DIRSIG&#39;: &#39;output/sig&#39;,
 &#39;DIRSIMUL&#39;: &#39;ini&#39;,
 &#39;DIRSLAB&#39;: &#39;ini&#39;,
 &#39;DIRSLAB2&#39;: &#39;ini&#39;,
 &#39;DIRTRA&#39;: &#39;output&#39;,
 &#39;DIRTUD&#39;: &#39;output&#39;,
 &#39;DIRTx&#39;: &#39;output/Tx001&#39;,
 &#39;DIRWEAR&#39;: &#39;body/wear&#39;,
 &#39;DIRWRL&#39;: &#39;struc/wrl&#39;}
</pre></div>
</div>
<p>The structure of the <code class="docutils literal notranslate"><span class="pre">.osm</span></code> file is shown below</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>%%bash
cd $BASENAME/struc
ls *.osm
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ls: impossible d&#39;accder  *.osm: Aucun fichier ou dossier de ce type
</pre></div>
</div>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>%%bash
 cd $BASENAME/struc
 head DLR.osm
 echo &#39;---&#39;
 tail -17 DLR.osm
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>head: impossible d&#39;ouvrir DLR.osm en lecture: Aucun fichier ou dossier de ce type
tail: impossible d&#39;ouvrir DLR.osm en lecture: Aucun fichier ou dossier de ce type
</pre></div>
</div>
<p>To read a new layout in osm format :</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L=Layout(&#39;DLR.ini&#39;)
</pre></div>
</div>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>fig,ax=L.showGs()
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_9_0.png" src="../../_images/LayoutEditor_9_0.png" />
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L.info()
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>filestr :  DLR.ini
filegeom :  DLR.off
boundaries  (-5.46865, 37.54965, -10.850249999999999, 11.45125)
number of Points : 109
number of Segments : 128
number of Sub-Segments : 30
Gs Nodes :  237
Gs Edges :  256
Gt Nodes :  0
Gt Edges :  0
vnodes = Gt.node[Nc][&#39;polyg&#39;].vnodes
poly = Gt.node[Nc][&#39;polyg&#39;]
Gr Nodes    : 0
Gr Edges    : 0
</pre></div>
</div>
<p>The different graphs associated with the layout are then built</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L.build()
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>building Layout ...
check len(ncycles) == 2 passed
</pre></div>
</div>
<p>The topological graph <span class="math notranslate nohighlight">\(\mathcal{G}_t\)</span> or graph of convex cycles.</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>f,a=L.showG(&#39;t&#39;)
b=plt.axis(&#39;off&#39;)
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_14_0.png" src="../../_images/LayoutEditor_14_0.png" />
<p>The graph of room <span class="math notranslate nohighlight">\(\mathcal{G}_r\)</span>. Two rooms which share at least
a wall are connected. Two rooms which share only a corner (punctual
connection) are not connected</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span># f,a=L.showG(&#39;r&#39;)
# b=plt.axis(&#39;off&#39;)
</pre></div>
</div>
<p>The graph of waypath <span class="math notranslate nohighlight">\(\mathcal{G}_w\)</span>. This graph is used for agent
mobility. It allows to determine the shortest path between 2 rooms.</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>#f,a=L.showG(&#39;w&#39;)
# b=plt.axis(&#39;off&#39;)
</pre></div>
</div>
<p>The graph of visibility <span class="math notranslate nohighlight">\(\mathcal{G_v}\)</span></p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>f,a=L.showG(&#39;v&#39;)
b=plt.axis(&#39;off&#39;)
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_20_0.png" src="../../_images/LayoutEditor_20_0.png" />
<p>The graph of interactions <span class="math notranslate nohighlight">\(\mathcal{G}_i\)</span> used to determine the
ray signatures.</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>f=plt.figure(figsize=(15,15))
a = f.gca()
f,a=L.showG(&#39;i&#39;,fig=f,ax=a)
b= plt.axis(&#39;off&#39;)
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_22_0.png" src="../../_images/LayoutEditor_22_0.png" />
</div>
<div class="section" id="the-display-options-dictionnary">
<h2>The display options dictionnary<a class="headerlink" href="#the-display-options-dictionnary" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L.info()
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>filestr :  DLR.ini
filegeom :  DLR.off
boundaries  (-5.46865, 37.54965, -10.850249999999999, 11.45125)
number of Points : 109
number of Segments : 141
number of Sub-Segments : 30
Gs Nodes :  250
Gs Edges :  282
Gt Nodes :  34
Gt Edges :  83
vnodes = Gt.node[Nc][&#39;polyg&#39;].vnodes
poly = Gt.node[Nc][&#39;polyg&#39;]
Gr Nodes    : 0
Gr Edges    : 0
</pre></div>
</div>
<p>The layout can be displayed using matplotlib plotting primitive. Several
display options are specified in the display dictionary. Those options
are exploited in <code class="docutils literal notranslate"><span class="pre">showGs()</span></code> visualization method.</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L.display
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;activelayer&#39;: &#39;WALL&#39;,
 &#39;alpha&#39;: 0.5,
 &#39;box&#39;: (-5.46865, 37.54965, -10.850249999999999, 11.45125),
 &#39;clear&#39;: True,
 &#39;edges&#39;: True,
 &#39;edlabel&#39;: False,
 &#39;edlblsize&#39;: 20,
 &#39;ednodes&#39;: True,
 &#39;fontsize&#39;: 10,
 &#39;layer&#39;: [],
 &#39;layers&#39;: [&#39;WALL&#39;,
  &#39;PARTITION&#39;,
  &#39;AIR&#39;,
  &#39;WINDOW_GLASS&#39;,
  &#39;3D_WINDOW_GLASS&#39;,
  &#39;_AIR&#39;],
 &#39;layerset&#39;: [&#39;WINDOW_GLASS&#39;,
  &#39;PLASTERBOARD_7CM&#39;,
  &#39;WALL&#39;,
  &#39;AIR&#39;,
  &#39;WINDOW&#39;,
  &#39;METALIC&#39;,
  &#39;PLASTERBOARD_14CM&#39;,
  &#39;DOOR&#39;,
  &#39;FLOOR&#39;,
  &#39;METAL&#39;,
  &#39;PARTITION&#39;,
  &#39;CONCRETE_20CM3D&#39;,
  &#39;PLASTERBOARD_10CM&#39;,
  &#39;CEIL&#39;,
  &#39;CONCRETE_6CM3D&#39;,
  &#39;CONCRETE_15CM3D&#39;,
  &#39;3D_WINDOW_GLASS&#39;,
  &#39;WALLS&#39;,
  &#39;WOOD&#39;,
  &#39;CONCRETE_7CM3D&#39;,
  &#39;PILLAR&#39;,
  &#39;ABSORBENT&#39;],
 &#39;ndlabel&#39;: False,
 &#39;ndlblsize&#39;: 20,
 &#39;ndsize&#39;: 10,
 &#39;nodes&#39;: True,
 &#39;overlay&#39;: False,
 &#39;overlay_axis&#39;: [-6.571295099826252,
  38.37510026097863,
  -11.339789148099044,
  11.170751733658253],
 &#39;overlay_file&#39;: &#39;DLR4991.png&#39;,
 &#39;overlay_flip&#39;: &#39;&#39;,
 &#39;scaled&#39;: True,
 &#39;subseg&#39;: True,
 &#39;subsegnb&#39;: True,
 &#39;thin&#39;: False,
 &#39;ticksoff&#39;: True,
 &#39;title&#39;: &#39;Init&#39;,
 &#39;transition&#39;: True,
 &#39;visu&#39;: False}
</pre></div>
</div>
<div class="section" id="layers">
<h3>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>‘layer’ : list , []</li>
<li>‘layerset’,list, list of available layers</li>
<li>‘layers’, list , []</li>
<li>‘activelayer’, str , ‘WINDOW_GLASS’</li>
<li>‘alpha’, float , 0.5 , overlay transparency</li>
<li>‘box’, tuple , (-20,20,-10,10), (xmin xmax,ymin,ymax)</li>
</ul>
</div>
<div class="section" id="strings">
<h3>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>‘title’ : str , ‘Init’</li>
<li>‘fileoverlay’ : str , ‘TA-Office.png’</li>
</ul>
</div>
<div class="section" id="sizes">
<h3>Sizes<a class="headerlink" href="#sizes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>‘fontsize’, float , 10</li>
<li>‘ndsize’, float , 10</li>
<li>‘ndlblsize’ : float 20</li>
<li>‘edlblsize’ : float , 20</li>
</ul>
</div>
<div class="section" id="booleans">
<h3>Booleans<a class="headerlink" href="#booleans" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>‘edlabel’, boolean, False</li>
<li>‘ticksoff’,boolean, True</li>
<li>‘scaled’ : boolean , True</li>
<li>‘subseg’ : boolean , True</li>
<li>‘nodes’, boolean , True</li>
<li>‘visu’, boolean , False</li>
<li>‘edges’, boolean , True</li>
<li>‘clear’, boolean, False</li>
<li>‘overlay’, boolean , False</li>
<li>‘thin’, boolean , False , If True trace all segments with thickness 1</li>
<li>‘ndlabel’,boolean, If True display node labels</li>
<li>‘ednodes’, boolean, True</li>
</ul>
</div>
</div>
<div class="section" id="interactive-editor">
<h2>Interactive Editor<a class="headerlink" href="#interactive-editor" title="Permalink to this headline">¶</a></h2>
<p>The command L.editor() launches an interactive editor. The state machine
is implemented in module <code class="docutils literal notranslate"><span class="pre">pylayers.gis.selectl.py</span></code>.</p>
<p>To have an idea of all available options, look in the</p>
<p><code class="docutils literal notranslate"><span class="pre">`pylayers.gis.SelectL</span></code> &lt;<a class="reference external" href="http://pylayers.github.io/pylayers/_modules/pylayers/gis/selectl.html#SelectL.new_state">http://pylayers.github.io/pylayers/_modules/pylayers/gis/selectl.html#SelectL.new_state</a>&gt;`__
module</p>
<p>PyLayers comes along with a low level structure editor based on
<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> which can be invoked using the <code class="docutils literal notranslate"><span class="pre">editor()</span></code> method. This
editor is more suited for modifying constitutive properties of walls. In
the future a dedicated plugin in <code class="docutils literal notranslate"><span class="pre">JOSM</span></code> could be a much better
solution.</p>
<p>There are two different modes of edition</p>
<ul class="simple">
<li>A <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">points</span></code> mode CP<ul>
<li>left clic : free point</li>
<li>right clic : same x point</li>
<li>center clic : same y point</li>
</ul>
</li>
<li>A <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">segments</span></code> mode<ul>
<li>left clic : select point 1</li>
<li>left clic : select point 2</li>
<li>left clic : create a segment between point 1 and point 2</li>
</ul>
</li>
</ul>
<p><strong>m</strong> : to switch from one mode to an other</p>
<p><strong>i</strong> : to return to init state</p>
<div class="section" id="image-overlay">
<h3>Image overlay<a class="headerlink" href="#image-overlay" title="Permalink to this headline">¶</a></h3>
<p>It is useful while editing a layout to have an overlay of an image in
order to help placing points. The image overlay can either be an url or
a filename. In that case the file is stored in</p>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L=Layout()
L.display[&#39;fileoverlay&#39;]=&#39;http://images.wikia.com/theoffice/images/9/9e/Layout.jpg&#39;
</pre></div>
</div>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L.display[&#39;overlay&#39;]=True
L.display[&#39;alpha&#39;]=1
L.display[&#39;scaled&#39;]=False
L.display[&#39;ticksoff&#39;]=False
L.display[&#39;inverse&#39;]=True
</pre></div>
</div>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>plt.figure(figsize=(10,10))
L.showGs()
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x7f8e3bb2cf50&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8e3bafe250&gt;)
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.figure.Figure at 0x7f8e3bb2c610&gt;
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_30_2.png" src="../../_images/LayoutEditor_30_2.png" />
</div>
<div class="section" id="scaling-the-figure-overlay">
<h3>Scaling the figure overlay<a class="headerlink" href="#scaling-the-figure-overlay" title="Permalink to this headline">¶</a></h3>
<p>Before going further it is necessary :</p>
<ul class="simple">
<li>to place the global origin</li>
<li>to precise the vertical and horizontal scale of the image</li>
</ul>
<p>This is done by the following commands :</p>
<ul class="simple">
<li>‘i’ : back to init state</li>
<li>‘m’ : goes to CP state</li>
<li>‘o’ : define the origin</li>
<li>‘left click’ on the point of the figure chasen as the origin</li>
<li>‘left click’ on a point at a known distance from the origin along x
axis. Fill the dialog box with the actual distance (expressed in
meters) between the two points.</li>
<li>‘left click’ on a point at a known distance from the origin along y
axis. Fill the dialog box with the actual distance (expressed in
meters) between the two points.</li>
</ul>
<p>In that sequence of operation it is useful to rescale the figure with
‘r’.</p>
<p>At that stage, it is possible to start creating points ‘b’ : select a
segment ‘l’ : select activelayer ‘i’ : back to init state ‘e’ : edit
segment ‘t’ : translate structure ‘h’ : add subsegment ‘d’ : delete
subsegment ‘r’ : refresh ‘o’ : toggle overlay ‘m’ : toggle mode (point
or segment) ‘z’ : change display parameters ‘q’ : quit interactive mode
‘x’ : save .str2 file ‘w’ : display all layers</p>
</div>
<div class="section" id="vizualisation-of-the-layout">
<h3>Vizualisation of the layout<a class="headerlink" href="#vizualisation-of-the-layout" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-none notranslate"><div class="highlight"><pre><span></span>L = Layout(&#39;TA-Office.ini&#39;)
fig = plt.figure(figsize=(25,25))
fig,ax = L.showG(graph=&#39;s&#39;,labels=True,font_size=9,node_size=220,node_color=&#39;c&#39;)
plt.axis(&#39;off&#39;)
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(-10.0, 50.0, -2.0, 16.0)
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.figure.Figure at 0x7f8e3b232ad0&gt;
</pre></div>
</div>
<img alt="../../_images/LayoutEditor_32_2.png" src="../../_images/LayoutEditor_32_2.png" />
<p>Each node of <span class="math notranslate nohighlight">\(\mathcal{G}_s\)</span> with a negative index is a point.</p>
<p>Each node of <span class="math notranslate nohighlight">\(\mathcal{G}_s\)</span> with a positive index corresponds to
a segment (wall,door,window,…).</p>
<p>The segment name is the key of the <strong>slab</strong> dictionnary.</p>
<p><a class="reference external" href="./Multisubsegments.html">Multi Subsegments</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, PyLayers developer team.
      Last updated on May 31, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>